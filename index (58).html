<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>مؤسسة فايز القثامي للمقاولات | نظام O.Y.D.F</title>
    
    <!-- Fonts & Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@300;400;500;600;700;800;900&family=Tajawal:wght@300;400;500;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css">
    
    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-storage-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-database-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-analytics-compat.js"></script>
    
    <!-- SweetAlert2 -->
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    
    <style>
        /* Reset & Base Styles */
        :root {
            --primary: #1a365d;
            --secondary: #2d6a4f;
            --accent: #d4af37;
            --dark: #1e293b;
            --light: #f8fafc;
            --gray: #64748b;
            --success: #10b981;
            --danger: #ef4444;
            --warning: #f59e0b;
            --info: #3b82f6;
            --radius: 12px;
            --shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
            --transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            --header-height: 80px;
            --nav-sidebar-width: 320px;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
        }
        
        html {
            scroll-behavior: smooth;
            overflow: hidden;
            height: 100%;
        }
        
        body {
            font-family: 'Cairo', 'Tajawal', sans-serif;
            background: var(--light);
            color: var(--dark);
            height: 100vh;
            overflow-x: hidden;
            overflow-y: auto;
            position: relative;
            padding-top: var(--header-height);
            padding-bottom: 100px;
            scrollbar-width: none;
            -ms-overflow-style: none;
        }
        
        body::-webkit-scrollbar {
            display: none;
        }
        
        /* زر تعديل القسم الجديد */
        .section-edit-btn {
            position: fixed;
            top: 100px;
            left: 30px;
            background: linear-gradient(135deg, var(--primary) 0%, var(--info) 100%);
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: var(--radius);
            font-weight: 700;
            cursor: pointer;
            z-index: 999999;
            display: none;
            align-items: center;
            gap: 10px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.3);
            transition: var(--transition);
        }
        
        .odo-mode .section-edit-btn,
        .edit-mode-active .section-edit-btn {
            display: flex;
        }
        
        .section-edit-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 30px rgba(0,0,0,0.4);
        }
        
        /* قائمة التعديل المنبثقة */
        .edit-section-dropdown {
            position: absolute;
            top: 100%;
            left: 0;
            background: white;
            border-radius: var(--radius);
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            width: 250px;
            max-height: 300px;
            overflow-y: auto;
            display: none;
            z-index: 1000000;
            border: 2px solid var(--info);
        }
        
        .edit-section-dropdown.active {
            display: block;
        }
        
        .edit-section-item {
            padding: 15px 20px;
            border-bottom: 1px solid #e2e8f0;
            cursor: pointer;
            transition: var(--transition);
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .edit-section-item:hover {
            background: #f1f5f9;
            transform: translateX(-5px);
        }
        
        .edit-section-item i {
            color: var(--primary);
            width: 20px;
        }
        
        .edit-section-item:last-child {
            border-bottom: none;
        }
        
        /* أنماط التعديل المحسنة */
        .floating-plus {
            position: fixed;
            width: 60px;
            height: 60px;
            background: linear-gradient(135deg, var(--primary) 0%, var(--info) 100%);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 2rem;
            cursor: pointer;
            z-index: 999999;
            box-shadow: 0 5px 20px rgba(0,0,0,0.3);
            transition: var(--transition);
            display: none;
        }
        
        .floating-plus:hover {
            transform: scale(1.2) rotate(90deg);
        }
        
        .floating-plus.active {
            display: flex;
        }
        
        .eye-toggle-btn {
            position: fixed;
            bottom: 200px;
            left: 30px;
            width: 60px;
            height: 60px;
            background: linear-gradient(135deg, var(--secondary) 0%, var(--primary) 100%);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 1.5rem;
            cursor: pointer;
            z-index: 999999;
            box-shadow: 0 5px 20px rgba(0,0,0,0.3);
            transition: var(--transition);
            display: none;
        }
        
        .eye-toggle-btn.active {
            display: flex;
        }
        
        .eye-toggle-btn:hover {
            transform: scale(1.1);
        }
        
        .section-visibility {
            position: absolute;
            top: 10px;
            left: 10px;
            background: var(--info);
            color: white;
            padding: 5px 10px;
            border-radius: 5px;
            font-size: 0.8rem;
            cursor: pointer;
            z-index: 1000;
            display: none;
        }
        
        .odo-mode .section-visibility {
            display: block;
        }
        
        .template-container {
            position: relative;
            border: 2px dashed #e2e8f0;
            border-radius: var(--radius);
            padding: 20px;
            margin: 20px 0;
            transition: var(--transition);
        }
        
        .odo-mode .template-container {
            border-color: var(--info);
        }
        
        .template-container:hover {
            background: #f8fafc;
        }
        
        .template-controls {
            position: absolute;
            top: -25px;
            left: 20px;
            display: flex;
            gap: 5px;
            background: var(--dark);
            padding: 5px;
            border-radius: 5px;
            display: none;
        }
        
        .template-container:hover .template-controls {
            display: flex;
        }
        
        .template-btn {
            width: 30px;
            height: 30px;
            border-radius: 5px;
            background: #374151;
            border: none;
            color: white;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: var(--transition);
        }
        
        .template-btn:hover {
            background: var(--info);
            transform: scale(1.1);
        }
        
        .hidden-section {
            opacity: 0.3;
            filter: blur(2px);
            pointer-events: none;
        }
        
        /* قسم المتجر الجديد */
        .store-section {
            background: linear-gradient(135deg, #f8fafc 0%, #e2e8f0 100%);
            padding: 40px;
            border-radius: var(--radius);
            margin: 40px 0;
            border: 2px solid #cbd5e1;
        }
        
        .store-products-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 25px;
            margin-top: 30px;
        }
        
        .store-product {
            background: white;
            border-radius: var(--radius);
            padding: 25px;
            box-shadow: var(--shadow);
            transition: var(--transition);
            position: relative;
        }
        
        .store-product:hover {
            transform: translateY(-10px);
        }
        
        /* قسم الموقع والمكان */
        .location-section {
            background: linear-gradient(135deg, var(--light) 0%, #e2e8f0 100%);
            padding: 40px;
            border-radius: var(--radius);
            margin: 40px 0;
            border: 2px solid var(--accent);
        }
        
        /* قسم إدارة الأقسام */
        .sections-manager {
            background: white;
            border-radius: var(--radius);
            padding: 30px;
            box-shadow: var(--shadow);
            margin: 30px 0;
        }
        
        .sections-list {
            display: flex;
            flex-direction: column;
            gap: 15px;
            margin: 20px 0;
        }
        
        .section-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px;
            background: #f8fafc;
            border-radius: var(--radius);
            border: 2px solid #e2e8f0;
        }
        
        /* قسم الثيمات والقوالب */
        .themes-section {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 20px;
            margin: 30px 0;
        }
        
        .theme-card {
            background: white;
            border-radius: var(--radius);
            padding: 25px;
            box-shadow: var(--shadow);
            cursor: pointer;
            transition: var(--transition);
            text-align: center;
            border: 2px solid transparent;
        }
        
        .theme-card:hover {
            transform: translateY(-10px);
            border-color: var(--info);
        }
        
        .theme-preview {
            width: 100%;
            height: 150px;
            border-radius: 10px;
            margin-bottom: 15px;
            background: linear-gradient(135deg, var(--primary), var(--info));
        }
        
        /* قسم التخزين المتقدم - معدل */
        .advanced-storage {
            background: white;
            border-radius: var(--radius);
            padding: 30px;
            margin: 30px 0;
            box-shadow: var(--shadow);
        }
        
        .storage-provider {
            display: flex;
            align-items: center;
            gap: 15px;
            padding: 15px;
            background: #f8fafc;
            border-radius: var(--radius);
            margin: 10px 0;
            border: 2px solid #e2e8f0;
            transition: var(--transition);
        }
        
        .storage-provider:hover {
            border-color: var(--info);
            transform: translateX(-5px);
        }
        
        .storage-connection-form {
            display: none;
            padding: 20px;
            background: #f1f5f9;
            border-radius: var(--radius);
            margin-top: 15px;
            border: 1px solid #e2e8f0;
        }
        
        .storage-connection-form.active {
            display: block;
        }
        
        /* بقية الأنماط كما هي... */
        
        /* Main Header - Responsive Fixed */
        .main-header {
            position: fixed;
            top: 0;
            right: 0;
            left: 0;
            height: var(--header-height);
            background: linear-gradient(135deg, var(--primary) 0%, #0f172a 100%);
            color: white;
            display: flex;
            flex-wrap: wrap;
            align-items: center;
            justify-content: space-between;
            padding: 0 15px;
            z-index: 10000;
            box-shadow: 0 4px 30px rgba(0, 0, 0, 0.2);
            border-bottom: 3px solid var(--accent);
            max-width: 100%;
            overflow: hidden;
            transition: height 0.3s ease;
        }
        
        /* Header Size Variations */
        .header-small {
            --header-height: 60px;
            height: 60px;
        }
        
        .header-small .logo-img {
            width: 40px;
            height: 40px;
        }
        
        .header-small .title-container h1 {
            font-size: 1rem;
        }
        
        .header-small .title-container p {
            font-size: 0.8rem;
        }
        
        .header-small .menu-toggle {
            width: 45px;
            height: 45px;
            font-size: 1.2rem;
        }
        
        .header-medium {
            --header-height: 80px;
            height: 80px;
        }
        
        .header-large {
            --header-height: 100px;
            height: 100px;
        }
        
        .header-large .logo-img {
            width: 70px;
            height: 70px;
        }
        
        .header-large .title-container h1 {
            font-size: 1.8rem;
        }
        
        .header-large .title-container p {
            font-size: 1.1rem;
        }
        
        .header-large .menu-toggle {
            width: 65px;
            height: 65px;
            font-size: 1.8rem;
        }
        
        .header-hidden {
            transform: translateY(-100%);
        }
        
        .logo-title-container {
            display: flex;
            align-items: center;
            gap: 15px;
            flex: 1;
            min-width: 0;
            overflow: hidden;
        }
        
        .logo-img {
            width: 60px;
            height: 60px;
            object-fit: contain;
            background: white;
            padding: 5px;
            border-radius: 50%;
            border: 2px solid var(--accent);
            animation: rotateLogo 20s linear infinite;
            flex-shrink: 0;
        }
        
        @keyframes rotateLogo {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        .title-container {
            min-width: 0;
            overflow: hidden;
        }
        
        .title-container h1 {
            font-size: 1.5rem;
            font-weight: 900;
            margin-bottom: 5px;
            color: white;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            max-width: 100%;
        }
        
        .title-container p {
            font-size: 0.95rem;
            color: var(--accent);
            font-weight: 600;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            max-width: 100%;
        }
        
        /* زر تعديل قسم رئيسي جديد */
        .edit-section-main-btn {
            background: linear-gradient(135deg, var(--secondary) 0%, var(--primary) 100%);
            color: white;
            border: none;
            padding: 15px 25px;
            border-radius: var(--radius);
            font-weight: 700;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 10px;
            margin: 20px auto;
            transition: var(--transition);
            display: none;
        }
        
        .edit-mode-active .edit-section-main-btn {
            display: flex;
        }
        
        .edit-section-main-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 20px rgba(0,0,0,0.2);
        }
        
        /* Odo Mode Floating Control Buttons */
        .odo-control-buttons {
            position: fixed;
            bottom: 120px;
            left: 30px;
            display: flex;
            flex-direction: column;
            gap: 15px;
            z-index: 100001;
            display: none;
        }
        
        .odo-mode .odo-control-buttons {
            display: flex;
        }
        
        .odo-control-btn {
            width: 70px;
            height: 70px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.8rem;
            color: white;
            border: none;
            cursor: pointer;
            transition: var(--transition);
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
        }
        
        .save-odo-btn {
            background: linear-gradient(135deg, var(--success) 0%, #047857 100%);
        }
        
        .exit-odo-btn {
            background: linear-gradient(135deg, var(--danger) 0%, #991b1b 100%);
        }
        
        .odo-control-btn:hover {
            transform: scale(1.1);
            box-shadow: 0 15px 40px rgba(0, 0, 0, 0.4);
        }
        
        /* Navigation Sidebar */
        .nav-sidebar {
            position: fixed;
            top: var(--header-height);
            right: 0;
            width: var(--nav-sidebar-width);
            height: calc(100vh - var(--header-height));
            background: rgba(255, 255, 255, 0.98);
            backdrop-filter: blur(15px);
            border-right: 1px solid rgba(0, 0, 0, 0.1);
            padding: 25px 20px;
            z-index: 9999;
            transform: translateX(100%);
            transition: transform 0.4s cubic-bezier(0.68, -0.55, 0.265, 1.55), width 0.3s ease;
            overflow-y: auto;
            overflow-x: hidden;
            box-shadow: -10px 0 40px rgba(0, 0, 0, 0.15);
        }
        
        /* Nav Sidebar Size Variations */
        .nav-sidebar-small {
            --nav-sidebar-width: 250px;
            width: 250px;
        }
        
        .nav-sidebar-medium {
            --nav-sidebar-width: 320px;
            width: 320px;
        }
        
        .nav-sidebar-large {
            --nav-sidebar-width: 400px;
            width: 400px;
        }
        
        .nav-sidebar-scroll-hidden {
            overflow-x: hidden;
            scrollbar-width: none;
        }
        
        .nav-sidebar-scroll-hidden::-webkit-scrollbar {
            display: none;
        }
        
        .nav-sidebar.active {
            transform: translateX(0);
        }
        
        .nav-sections-container {
            overflow-x: auto;
            padding-bottom: 10px;
            margin-bottom: 20px;
            scrollbar-width: thin;
            scrollbar-color: var(--info) transparent;
        }
        
        .nav-sections-container::-webkit-scrollbar {
            height: 6px;
        }
        
        .nav-sections-container::-webkit-scrollbar-track {
            background: transparent;
        }
        
        .nav-sections-container::-webkit-scrollbar-thumb {
            background: var(--info);
            border-radius: 3px;
        }
        
        .nav-sections {
            display: flex;
            flex-direction: column;
            gap: 10px;
            min-width: min-content;
        }
        
        /* Search Box */
        .search-box {
            width: 100%;
            padding: 15px 20px;
            border: 2px solid #e2e8f0;
            border-radius: var(--radius);
            margin-bottom: 30px;
            font-size: 1rem;
            background: white;
            transition: var(--transition);
            max-width: 100%;
            box-sizing: border-box;
        }
        
        .search-box:focus {
            border-color: var(--info);
            outline: none;
            box-shadow: 0 0 0 4px rgba(59, 130, 246, 0.2);
        }
        
        .nav-section-item {
            padding: 18px 20px;
            border-radius: var(--radius);
            background: white;
            border: 2px solid transparent;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 15px;
            font-weight: 600;
            color: var(--dark);
            transition: var(--transition);
            position: relative;
            min-width: 200px;
        }
        
        .nav-section-item:hover {
            background: #f1f5f9;
            transform: translateX(-10px);
            border-color: var(--info);
        }
        
        .nav-section-item i {
            font-size: 1.3rem;
            color: var(--primary);
            width: 30px;
            text-align: center;
        }
        
        .hidden-key-btn {
            background: linear-gradient(135deg, var(--secondary) 0%, var(--primary) 100%);
            color: white;
            padding: 18px;
            border-radius: var(--radius);
            text-align: center;
            font-weight: 700;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 15px;
            margin-top: 20px;
            transition: var(--transition);
            border: 2px solid transparent;
        }
        
        .hidden-key-btn:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 30px rgba(45, 106, 79, 0.3);
            border-color: var(--accent);
        }
        
        /* Main Content */
        .main-content {
            padding: 40px 30px;
            max-width: 1400px;
            margin: 0 auto;
        }
        
        .content-section {
            display: none;
            animation: fadeInUp 0.8s ease;
        }
        
        .content-section.active {
            display: block;
        }
        
        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(40px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        .section-header {
            text-align: center;
            margin-bottom: 50px;
        }
        
        .section-title {
            font-size: 2.5rem;
            color: var(--primary);
            margin-bottom: 15px;
            font-weight: 900;
            position: relative;
            display: inline-block;
        }
        
        .section-title::after {
            content: '';
            position: absolute;
            bottom: -10px;
            right: 50%;
            transform: translateX(50%);
            width: 150px;
            height: 5px;
            background: linear-gradient(to right, var(--accent), var(--info));
            border-radius: 5px;
        }
        
        /* Products Grid */
        .products-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));
            gap: 35px;
            margin-bottom: 60px;
        }
        
        .product-card {
            background: white;
            border-radius: var(--radius);
            overflow: hidden;
            box-shadow: var(--shadow);
            transition: var(--transition);
            border: 1px solid #e2e8f0;
            position: relative;
            opacity: 0;
            transform: translateY(50px) scale(0.95);
        }
        
        .product-card.revealed {
            opacity: 1;
            transform: translateY(0) scale(1);
        }
        
        .product-card:hover {
            transform: translateY(-15px) scale(1.02);
            box-shadow: 0 25px 50px rgba(0, 0, 0, 0.15);
        }
        
        .product-media {
            width: 100%;
            height: 250px;
            object-fit: cover;
            border-bottom: 1px solid #e2e8f0;
        }
        
        .product-content {
            padding: 25px;
        }
        
        .product-title {
            font-size: 1.6rem;
            color: var(--primary);
            margin-bottom: 12px;
            font-weight: 800;
        }
        
        .product-description {
            color: var(--gray);
            line-height: 1.7;
            margin-bottom: 20px;
            font-size: 1.05rem;
        }
        
        .product-price {
            font-size: 1.8rem;
            color: var(--secondary);
            font-weight: 900;
            margin-bottom: 25px;
        }
        
        .product-actions {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
        }
        
        .action-btn {
            padding: 15px 25px;
            border-radius: var(--radius);
            border: none;
            font-family: inherit;
            font-weight: 700;
            cursor: pointer;
            transition: var(--transition);
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            font-size: 1rem;
        }
        
        .order-btn {
            background: linear-gradient(135deg, var(--primary) 0%, var(--info) 100%);
            color: white;
        }
        
        .order-btn:hover {
            background: linear-gradient(135deg, var(--info) 0%, var(--primary) 100%);
            transform: translateY(-3px);
            box-shadow: 0 10px 20px rgba(59, 130, 246, 0.3);
        }
        
        .download-btn {
            background: var(--light);
            color: var(--dark);
            border: 2px solid #e2e8f0;
        }
        
        .download-btn:hover {
            background: #e2e8f0;
            border-color: var(--gray);
        }
        
        /* Fixed CTA Buttons */
        .fixed-cta-container {
            position: fixed;
            bottom: 30px;
            right: 30px;
            left: 30px;
            display: flex;
            justify-content: space-between;
            z-index: 9000;
            pointer-events: none;
        }
        
        .fixed-cta {
            width: 70px;
            height: 70px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2rem;
            color: white;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
            cursor: pointer;
            transition: var(--transition);
            pointer-events: all;
            animation: pulseCTA 2s infinite;
            border: 3px solid white;
        }
        
        @keyframes pulseCTA {
            0% { transform: scale(1); }
            50% { transform: scale(1.1); }
            100% { transform: scale(1); }
        }
        
        .whatsapp-cta {
            background: linear-gradient(135deg, #25D366 0%, #128C7E 100%);
        }
        
        .call-cta {
            background: linear-gradient(135deg, var(--info) 0%, #1e40af 100%);
        }
        
        .fixed-cta:hover {
            transform: scale(1.2) rotate(10deg);
            box-shadow: 0 15px 40px rgba(0, 0, 0, 0.4);
        }
        
        /* Programmer Section - Updated with 3D effects */
        .programmer-section {
            background: linear-gradient(135deg, var(--primary) 0%, #0f172a 100%);
            color: white;
            padding: 60px 40px;
            border-radius: var(--radius);
            text-align: center;
            margin: 60px auto;
            max-width: 900px;
            box-shadow: 0 25px 50px rgba(26, 54, 93, 0.3);
            position: relative;
            overflow: hidden;
            transform-style: preserve-3d;
            perspective: 1000px;
        }
        
        .programmer-section::before {
            content: '';
            position: absolute;
            top: -50%;
            right: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle, rgba(212, 175, 55, 0.1) 0%, transparent 70%);
            animation: rotateBG 30s linear infinite;
        }
        
        @keyframes rotateBG {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        .programmer-logo {
            width: 150px;
            height: 150px;
            object-fit: contain;
            margin-bottom: 30px;
            border-radius: 50%;
            border: 5px solid var(--accent);
            background: white;
            padding: 20px;
            animation: floatLogo 6s ease-in-out infinite;
            transform: translateZ(50px);
            box-shadow: 0 20px 40px rgba(0,0,0,0.5);
        }
        
        @keyframes floatLogo {
            0%, 100% { transform: translateY(0) translateZ(50px); }
            50% { transform: translateY(-20px) translateZ(50px); }
        }
        
        .programmer-title {
            font-size: 2.2rem;
            margin-bottom: 20px;
            font-weight: 900;
            color: var(--accent);
            transform: translateZ(30px);
            text-shadow: 0 5px 15px rgba(0,0,0,0.5);
        }
        
        .programmer-description {
            font-size: 1.2rem;
            line-height: 1.8;
            max-width: 700px;
            margin: 0 auto 30px;
            color: #cbd5e1;
            transform: translateZ(20px);
        }
        
        /* Social Links */
        .social-section {
            text-align: center;
            margin: 80px 0;
            padding: 50px 30px;
            background: linear-gradient(135deg, #f8fafc 0%, #e2e8f0 100%);
            border-radius: var(--radius);
            border: 2px solid #cbd5e1;
        }
        
        .social-title {
            font-size: 2rem;
            color: var(--primary);
            margin-bottom: 40px;
            font-weight: 900;
        }
        
        .social-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(80px, 1fr));
            gap: 20px;
            max-width: 900px;
            margin: 0 auto;
        }
        
        .social-icon {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            background: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2rem;
            color: var(--dark);
            text-decoration: none;
            transition: var(--transition);
            border: 2px solid transparent;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }
        
        .social-icon:hover {
            transform: translateY(-10px) scale(1.1);
            box-shadow: 0 15px 30px rgba(0, 0, 0, 0.2);
            border-color: var(--accent);
        }
        
        .social-icon.whatsapp { color: #25D366; }
        .social-icon.phone { color: var(--info); }
        .social-icon.instagram { color: #E1306C; }
        .social-icon.tiktok { color: #000000; }
        .social-icon.snapchat { color: #FFFC00; }
        .social-icon.twitter { color: #1DA1F2; }
        .social-icon.facebook { color: #1877F2; }
        .social-icon.youtube { color: #FF0000; }
        .social-icon.telegram { color: #0088cc; }
        
        /* Footer */
        .main-footer {
            background: var(--dark);
            color: white;
            padding: 60px 30px 30px;
            margin-top: 80px;
            text-align: center;
        }
        
        .footer-content {
            max-width: 1200px;
            margin: 0 auto;
        }
        
        .footer-title {
            font-size: 1.8rem;
            color: var(--accent);
            margin-bottom: 20px;
            font-weight: 900;
        }
        
        .footer-contact {
            display: flex;
            justify-content: center;
            gap: 30px;
            margin: 40px 0;
            flex-wrap: wrap;
        }
        
        .contact-item {
            padding: 20px 30px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: var(--radius);
            display: flex;
            align-items: center;
            gap: 15px;
            font-size: 1.2rem;
            transition: var(--transition);
            cursor: pointer;
        }
        
        .contact-item:hover {
            background: rgba(255, 255, 255, 0.2);
            transform: translateY(-5px);
        }
        
        .footer-info {
            margin-top: 40px;
            padding-top: 30px;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
            color: #cbd5e1;
            font-size: 1rem;
        }
        
        .saudi-flag {
            display: inline-flex;
            align-items: center;
            gap: 10px;
            margin-top: 20px;
            padding: 10px 20px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: var(--radius);
        }
        
        .flag-icon {
            width: 30px;
            height: 22px;
            background: linear-gradient(to bottom, #006233 33%, white 33%, white 66%, #006233 66%);
            position: relative;
        }
        
        .flag-icon::before {
            content: "الله أكبر";
            position: absolute;
            top: 50%;
            right: 8px;
            transform: translateY(-50%);
            color: white;
            font-size: 0.7rem;
            font-weight: 900;
            text-align: center;
            line-height: 1.2;
        }
        
        /* O.Y.D.F Control Panel */
        .control-panel-overlay {
            position: fixed;
            top: 0;
            right: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.95);
            z-index: 20000;
            display: none;
            align-items: center;
            justify-content: center;
            padding: 20px;
            backdrop-filter: blur(10px);
        }
        
        .control-panel {
            background: white;
            width: 100%;
            max-width: 1400px;
            height: 90vh;
            border-radius: 25px;
            overflow: hidden;
            display: flex;
            flex-direction: column;
            box-shadow: 0 40px 80px rgba(0, 0, 0, 0.5);
            animation: panelIn 0.5s cubic-bezier(0.68, -0.55, 0.265, 1.55);
        }
        
        @keyframes panelIn {
            from {
                opacity: 0;
                transform: scale(0.8) translateY(100px);
            }
            to {
                opacity: 1;
                transform: scale(1) translateY(0);
            }
        }
        
        .panel-header {
            background: linear-gradient(135deg, var(--primary) 0%, #0f172a 100%);
            color: white;
            padding: 25px 40px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            border-bottom: 3px solid var(--accent);
        }
        
        .panel-title {
            font-size: 2rem;
            display: flex;
            align-items: center;
            gap: 20px;
            font-weight: 900;
        }
        
        .panel-close {
            background: var(--danger);
            color: white;
            border: none;
            width: 60px;
            height: 60px;
            border-radius: 50%;
            font-size: 1.8rem;
            cursor: pointer;
            transition: var(--transition);
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .panel-close:hover {
            background: #dc2626;
            transform: rotate(90deg);
        }
        
        .panel-body {
            display: flex;
            flex: 1;
            overflow: hidden;
        }
        
        .panel-sidebar {
            width: 300px;
            background: #f8fafc;
            border-left: 1px solid #e2e8f0;
            padding: 30px 20px;
            overflow-y: auto;
        }
        
        .panel-tabs {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }
        
        .panel-tab {
            padding: 22px 25px;
            border-radius: var(--radius);
            background: white;
            border: 2px solid #e2e8f0;
            cursor: pointer;
            font-weight: 700;
            color: var(--dark);
            transition: var(--transition);
            display: flex;
            align-items: center;
            gap: 20px;
            font-size: 1.1rem;
        }
        
        .panel-tab:hover {
            background: #e2e8f0;
            transform: translateX(-10px);
            border-color: var(--info);
        }
        
        .panel-tab.active {
            background: linear-gradient(135deg, var(--info) 0%, var(--primary) 100%);
            color: white;
            border-color: var(--info);
            transform: translateX(-10px);
        }
        
        .panel-tab i {
            font-size: 1.3rem;
            width: 30px;
            text-align: center;
        }
        
        .panel-content {
            flex: 1;
            padding: 40px;
            overflow-y: auto;
            background: white;
        }
        
        .tab-content {
            display: none;
            animation: fadeIn 0.5s ease;
        }
        
        .tab-content.active {
            display: block;
        }
        
        .form-group {
            margin-bottom: 30px;
        }
        
        .form-label {
            display: block;
            margin-bottom: 15px;
            font-weight: 700;
            color: var(--primary);
            font-size: 1.2rem;
        }
        
        .form-input, .form-select, .form-textarea {
            width: 100%;
            padding: 18px 25px;
            border: 2px solid #e2e8f0;
            border-radius: var(--radius);
            font-family: inherit;
            font-size: 1.1rem;
            transition: var(--transition);
            background: white;
        }
        
        .form-input:focus, .form-select:focus, .form-textarea:focus {
            border-color: var(--info);
            outline: none;
            box-shadow: 0 0 0 4px rgba(59, 130, 246, 0.2);
        }
        
        .form-textarea {
            min-height: 150px;
            resize: vertical;
        }
        
        .btn-group {
            display: flex;
            gap: 20px;
            margin-top: 30px;
            flex-wrap: wrap;
        }
        
        .btn {
            padding: 18px 35px;
            border-radius: var(--radius);
            border: none;
            font-family: inherit;
            font-weight: 700;
            cursor: pointer;
            transition: var(--transition);
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 12px;
            font-size: 1.1rem;
            min-width: 180px;
        }
        
        .btn-primary {
            background: linear-gradient(135deg, var(--primary) 0%, var(--info) 100%);
            color: white;
        }
        
        .btn-primary:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 30px rgba(26, 54, 93, 0.3);
        }
        
        .btn-secondary {
            background: #e2e8f0;
            color: var(--dark);
            border: 2px solid #cbd5e0;
        }
        
        .btn-secondary:hover {
            background: #cbd5e0;
        }
        
        .btn-danger {
            background: linear-gradient(135deg, var(--danger) 0%, #991b1b 100%);
            color: white;
        }
        
        .btn-success {
            background: linear-gradient(135deg, var(--success) 0%, #047857 100%);
            color: white;
        }
        
        /* Storage Options */
        .storage-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 25px;
            margin-top: 30px;
        }
        
        .storage-option {
            background: white;
            border-radius: var(--radius);
            padding: 30px;
            text-align: center;
            border: 2px solid #e2e8f0;
            cursor: pointer;
            transition: var(--transition);
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 20px;
        }
        
        .storage-option:hover {
            border-color: var(--info);
            transform: translateY(-10px);
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
        }
        
        .storage-icon {
            font-size: 3rem;
            width: 80px;
            height: 80px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
            background: #f1f5f9;
        }
        
        .storage-option.firebase .storage-icon { color: #FFCA28; }
        .storage-option.google .storage-icon { color: #4285F4; }
        .storage-option.icloud .storage-icon { color: #000000; }
        .storage-option.local .storage-icon { color: var(--primary); }
        .storage-option.mega .storage-icon { color: #D90007; }
        .storage-option.terabox .storage-icon { color: #3B82F6; }
        
        /* Odoo Editor Mode */
        .odo-mode .editable-element {
            position: relative;
            outline: 2px dashed var(--info) !important;
            min-height: 20px;
            cursor: move;
        }
        
        .odo-mode .editable-element:hover::before {
            content: attr(data-edit-tooltip);
            position: absolute;
            top: -35px;
            right: 0;
            background: var(--info);
            color: white;
            padding: 8px 15px;
            border-radius: 8px;
            font-size: 0.9rem;
            white-space: nowrap;
            z-index: 100000;
            pointer-events: none;
        }
        
        .edit-toolbar {
            position: absolute;
            top: -50px;
            right: 0;
            background: var(--dark);
            border-radius: 12px;
            padding: 12px;
            display: flex;
            gap: 8px;
            z-index: 100000;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
            display: none;
        }
        
        .editable-element:hover .edit-toolbar {
            display: flex;
        }
        
        .toolbar-btn {
            width: 40px;
            height: 40px;
            border-radius: 8px;
            background: #374151;
            border: none;
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            font-size: 1.1rem;
            transition: var(--transition);
        }
        
        .toolbar-btn:hover {
            background: var(--info);
            transform: scale(1.1);
        }
        
        /* Loading Screen */
        .loading-screen {
            position: fixed;
            top: 0;
            right: 0;
            width: 100%;
            height: 100%;
            background: var(--primary);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            z-index: 99999;
            transition: opacity 0.5s, visibility 0.5s;
        }
        
        .loading-screen.hidden {
            opacity: 0;
            visibility: hidden;
        }
        
        .loader {
            width: 100px;
            height: 100px;
            border: 8px solid rgba(255, 255, 255, 0.2);
            border-top-color: var(--accent);
            border-radius: 50%;
            animation: spin 1.5s linear infinite;
            margin-bottom: 30px;
        }
        
        .loading-text {
            color: white;
            font-size: 1.5rem;
            font-weight: 700;
            animation: pulse 1.5s infinite;
        }
        
        /* العودة للتعديل زر جديد */
        .back-to-edit-btn {
            position: fixed;
            top: 20px;
            left: 20px;
            background: linear-gradient(135deg, var(--info) 0%, var(--primary) 100%);
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: var(--radius);
            font-weight: 700;
            cursor: pointer;
            z-index: 100001;
            display: none;
            align-items: center;
            gap: 10px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.3);
            transition: var(--transition);
        }
        
        .odo-mode .back-to-edit-btn {
            display: flex;
        }
        
        .back-to-edit-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 30px rgba(0,0,0,0.4);
        }
        
        /* زر إخفاء قائمة الإعدادات */
        .hide-settings-btn {
            position: absolute;
            top: 20px;
            left: 20px;
            background: var(--warning);
            color: white;
            border: none;
            width: 50px;
            height: 50px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            z-index: 100002;
            display: none;
            font-size: 1.2rem;
        }
        
        .odo-mode .hide-settings-btn {
            display: flex;
        }
        
        /* زر العين فوق زر الحفظ */
        .eye-above-save {
            position: absolute;
            top: -60px;
            right: 0;
            background: var(--secondary);
            color: white;
            width: 50px;
            height: 50px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            z-index: 100003;
            font-size: 1.2rem;
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
            transition: var(--transition);
            display: none;
        }
        
        .odo-mode .eye-above-save {
            display: flex;
        }
        
        .eye-above-save:hover {
            transform: scale(1.1);
        }
        
        /* محرر O.Y.D.F منظم */
        .editor-tools-container {
            background: white;
            border-radius: var(--radius);
            padding: 30px;
            box-shadow: var(--shadow);
            margin-bottom: 30px;
        }
        
        .editor-tools-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }
        
        .editor-tool {
            background: #f8fafc;
            border-radius: var(--radius);
            padding: 25px;
            text-align: center;
            cursor: pointer;
            transition: var(--transition);
            border: 2px solid #e2e8f0;
        }
        
        .editor-tool:hover {
            border-color: var(--info);
            transform: translateY(-5px);
        }
        
        /* Responsive */
        @media (max-width: 1200px) {
            .products-grid {
                grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            }
            
            .nav-sidebar {
                width: 100%;
            }
        }
        
        @media (max-width: 768px) {
            .main-header {
                padding: 0 10px;
                flex-wrap: nowrap;
                overflow: hidden;
            }
            
            .logo-title-container {
                gap: 10px;
            }
            
            .logo-img {
                width: 45px;
                height: 45px;
            }
            
            .title-container h1 {
                font-size: 1rem;
                white-space: normal;
                overflow: visible;
                text-overflow: clip;
                line-height: 1.2;
            }
            
            .title-container p {
                font-size: 0.8rem;
                white-space: normal;
                line-height: 1.2;
            }
            
            .main-content {
                padding: 20px 10px;
            }
            
            .section-title {
                font-size: 1.8rem;
            }
            
            .products-grid {
                grid-template-columns: 1fr;
                gap: 20px;
            }
            
            .fixed-cta {
                width: 55px;
                height: 55px;
                font-size: 1.3rem;
            }
            
            .fixed-cta-container {
                bottom: 15px;
                right: 15px;
                left: 15px;
            }
            
            .odo-control-buttons {
                left: 15px;
                bottom: 100px;
            }
            
            .odo-control-btn {
                width: 55px;
                height: 55px;
                font-size: 1.3rem;
            }
            
            .panel-body {
                flex-direction: column;
            }
            
            .panel-sidebar {
                width: 100%;
                height: auto;
                max-height: 300px;
            }
            
            .btn {
                min-width: 100%;
            }
            
            .chat-container {
                height: 500px;
            }
            
            .floating-plus {
                width: 50px;
                height: 50px;
                font-size: 1.5rem;
            }
            
            .eye-toggle-btn {
                width: 50px;
                height: 50px;
                font-size: 1.2rem;
                bottom: 150px;
                left: 15px;
            }
            
            .back-to-edit-btn {
                top: 10px;
                left: 10px;
                padding: 10px 15px;
                font-size: 0.9rem;
            }
            
            .eye-above-save {
                width: 40px;
                height: 40px;
                font-size: 1rem;
                top: -50px;
            }
            
            .section-edit-btn {
                top: 80px;
                left: 15px;
                padding: 10px 15px;
                font-size: 0.9rem;
            }
            
            .edit-section-main-btn {
                padding: 12px 20px;
                font-size: 0.9rem;
            }
        }
        
        @media (max-width: 480px) {
            .product-actions {
                grid-template-columns: 1fr;
            }
            
            .social-grid {
                grid-template-columns: repeat(auto-fit, minmax(60px, 1fr));
            }
            
            .social-icon {
                width: 60px;
                height: 60px;
                font-size: 1.5rem;
            }
            
            .footer-contact {
                flex-direction: column;
                gap: 15px;
            }
            
            .title-container h1 {
                font-size: 0.9rem;
            }
            
            .title-container p {
                font-size: 0.7rem;
            }
            
            .floating-plus {
                width: 45px;
                height: 45px;
                font-size: 1.3rem;
            }
            
            .back-to-edit-btn {
                font-size: 0.8rem;
                padding: 8px 12px;
            }
            
            .section-edit-btn {
                font-size: 0.8rem;
                padding: 8px 12px;
            }
        }
        
        @media (max-width: 360px) {
            .main-header {
                padding: 0 5px;
            }
            
            .logo-img {
                width: 35px;
                height: 35px;
            }
            
            .title-container h1 {
                font-size: 0.8rem;
            }
            
            .title-container p {
                font-size: 0.6rem;
            }
            
            .menu-toggle {
                width: 40px;
                height: 40px;
                font-size: 1rem;
            }
            
            .floating-plus {
                width: 40px;
                height: 40px;
                font-size: 1.1rem;
            }
            
            .section-edit-btn {
                font-size: 0.7rem;
                padding: 6px 10px;
            }
        }
    </style>
</head>
<body>
    <!-- Loading Screen -->
    <div class="loading-screen" id="loadingScreen">
        <div class="loader"></div>
        <div class="loading-text">جارٍ تحميل نظام O.Y.D.F...</div>
    </div>
    
    <!-- زر تعديل القسم الجديد -->
    <button class="section-edit-btn" id="sectionEditBtn">
        <i class="fas fa-edit"></i>
        <span>تعديل القسم</span>
    </button>
    
    <!-- زر العودة للتعديل -->
    <button class="back-to-edit-btn" id="backToEditBtn">
        <i class="fas fa-edit"></i>
        <span>العودة للتعديل</span>
    </button>
    
    <!-- زر إخفاء قائمة الإعدادات -->
    <button class="hide-settings-btn" id="hideSettingsBtn" title="إخفاء قائمة الإعدادات">
        <i class="fas fa-eye-slash"></i>
    </button>
    
    <!-- زر العين فوق زر الحفظ -->
    <button class="eye-above-save" id="eyeAboveSaveBtn" title="إظهار/إخفاء أدوات التعديل">
        <i class="fas fa-eye"></i>
    </button>
    
    <!-- Floating Plus Button for Odo Mode -->
    <div class="floating-plus" id="floatingPlus" title="إضافة عنصر جديد">
        <i class="fas fa-plus"></i>
    </div>
    
    <!-- Eye Toggle Button -->
    <div class="eye-toggle-btn" id="eyeToggleBtn" title="إظهار/إخفاء العناصر">
        <i class="fas fa-eye"></i>
    </div>
    
    <!-- Odo Mode Floating Control Buttons -->
    <div class="odo-control-buttons" id="odoControlButtons">
        <button class="odo-control-btn save-odo-btn" id="saveOdoBtn" title="حفظ التعديلات">
            <i class="fas fa-save"></i>
        </button>
        <button class="odo-control-btn exit-odo-btn" id="exitOdoBtn" title="خروج من وضع التعديل">
            <i class="fas fa-sign-out-alt"></i>
        </button>
    </div>
    
    <!-- Main Header -->
    <header class="main-header" id="mainHeader">
        <div class="logo-title-container">
            <img src="https://cdn-icons-png.flaticon.com/512/2206/2206633.png" alt="لوجو المؤسسة" class="logo-img" id="siteLogo">
            <div class="title-container">
                <h1 id="siteName">مؤسسة فايز القثامي للمقاولات</h1>
                <p id="siteDescription">تصنيع وتوريد وتركيب الجي آر سي</p>
            </div>
        </div>
        
        <button class="menu-toggle" id="menuToggle" style="background: var(--accent); color: white; border: none; width: 55px; height: 55px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 1.5rem; cursor: pointer; transition: var(--transition);">
            <i class="fas fa-bars"></i>
        </button>
    </header>
    
    <!-- Navigation Sidebar -->
    <nav class="nav-sidebar" id="navSidebar">
        <input type="text" class="search-box" placeholder="🔍 ابحث في الموقع..." id="siteSearch">
        
        <div class="nav-sections-container">
            <div class="nav-sections" id="navSections">
                <div class="nav-section-item" data-section="home">
                    <i class="fas fa-home"></i>
                    <span>الرئيسية</span>
                </div>
                <div class="nav-section-item" data-section="products">
                    <i class="fas fa-images"></i>
                    <span>صور المنتجات</span>
                </div>
                <div class="nav-section-item" data-section="videos">
                    <i class="fas fa-video"></i>
                    <span>فيديوهات المنتجات</span>
                </div>
                <div class="nav-section-item" data-section="comments">
                    <i class="fas fa-comment-dots"></i>
                    <span>التعليقات</span>
                </div>
                <div class="nav-section-item" data-section="programmer">
                    <i class="fas fa-code"></i>
                    <span>المبرمج</span>
                </div>
                <!-- قسم المتجر الجديد -->
                <div class="nav-section-item" data-section="store" id="storeSectionItem">
                    <i class="fas fa-store"></i>
                    <span>المتجر</span>
                </div>
                <!-- قسم الموقع والمكان -->
                <div class="nav-section-item" data-section="location" id="locationSectionItem" style="display: none;">
                    <i class="fas fa-map-marker-alt"></i>
                    <span>الموقع والمكان</span>
                </div>
            </div>
        </div>
        
        <div class="hidden-key-btn" id="hiddenKeyBtn">
            <i class="fas fa-key"></i>
            <span>لوحة التحكم المخفية</span>
        </div>
    </nav>
    
    <!-- Main Content -->
    <main class="main-content" id="mainContent">
        <!-- زر تعديل قسم رئيسي في كل قسم -->
        <button class="edit-section-main-btn" id="editSectionMainBtn">
            <i class="fas fa-edit"></i>
            <span>تعديل هذا القسم</span>
        </button>
        
        <!-- Home Section -->
        <section id="home-section" class="content-section active">
            <div class="section-header">
                <h2 class="section-title">مرحباً بكم في مؤسسة فايز القثامي</h2>
                <p style="font-size: 1.2rem; color: var(--gray); max-width: 800px; margin: 20px auto; line-height: 1.8;">
                    نقدم لكم أفضل ديكورات الجي آر سي بتقنيات عالية الجودة وأسعار تنافسية. خبرة تتجاوز 15 عاماً في التصنيع والتركيب.
                </p>
            </div>
            
            <div class="products-grid" id="homeProductsGrid">
                <!-- سيتم ملؤه ديناميكياً -->
            </div>
            
            <!-- قسم المبرمج في الرئيسية -->
            <div class="programmer-section">
                <img src="https://cdn-icons-png.flaticon.com/512/4727/4727496.png" alt="لوجو O.Y.D.F" class="programmer-logo" id="programmerLogo">
                <h3 class="programmer-title" id="programmerTitle">O.Y.D.F للبرمجيات والتطوير</h3>
                <p class="programmer-description" id="programmerDescription">
                    نظام إدارة محتوى متكامل (CMS) بتقنيات حديثة وعالية الأداء. يمكنك تعديل كل شيء في الموقع بشكل مباشر وسهل بعد تفعيل كود التعديل.
                </p>
                <div style="display: flex; gap: 20px; justify-content: center; flex-wrap: wrap; margin-top: 30px;">
                    <button class="btn btn-primary" onclick="openControlPanel()">
                        <i class="fas fa-cogs"></i>
                        <span>لوحة التحكم</span>
                    </button>
                    <button class="btn btn-secondary" onclick="activateEditMode()">
                        <i class="fas fa-edit"></i>
                        <span>تفعيل التعديل</span>
                    </button>
                </div>
            </div>
        </section>
        
        <!-- Products Section -->
        <section id="products-section" class="content-section">
            <div class="section-header">
                <h2 class="section-title">معرض منتجاتنا</h2>
                <p style="font-size: 1.2rem; color: var(--gray); max-width: 800px; margin: 20px auto;">
                    تصفح مجموعة منتجاتنا من ديكورات الجي آر سي عالية الجودة
                </p>
            </div>
            
            <div class="products-grid" id="productsGrid">
                <!-- سيتم ملؤه ديناميكياً -->
            </div>
        </section>
        
        <!-- Videos Section -->
        <section id="videos-section" class="content-section">
            <div class="section-header">
                <h2 class="section-title">فيديوهات المنتجات</h2>
                <p style="font-size: 1.2rem; color: var(--gray); max-width: 800px; margin: 20px auto;">
                    شاهد فيديوهات تعرض جودة منتجاتنا وتفاصيل التصنيع والتركيب
                </p>
            </div>
            
            <div class="products-grid" id="videosGrid">
                <!-- سيتم ملؤه ديناميكياً -->
            </div>
        </section>
        
        <!-- Comments Section -->
        <section id="comments-section" class="content-section">
            <div class="section-header">
                <h2 class="section-title">تعليقات العملاء</h2>
                <p style="font-size: 1.2rem; color: var(--gray); max-width: 800px; margin: 20px auto;">
                    آراء عملائنا الكرام حول خدماتنا ومنتجاتنا
                </p>
            </div>
            
            <div id="commentsContainer" style="max-width: 800px; margin: 0 auto;">
                <!-- سيتم ملؤه ديناميكياً -->
            </div>
            
            <div style="max-width: 800px; margin: 50px auto; background: white; padding: 40px; border-radius: var(--radius); box-shadow: var(--shadow);">
                <h3 style="color: var(--primary); margin-bottom: 25px; font-size: 1.8rem;">أضف تعليقك</h3>
                <div style="display: flex; flex-direction: column; gap: 25px;">
                    <input type="text" id="commentName" class="form-input" placeholder="اسمك">
                    <textarea id="commentText" class="form-textarea" placeholder="تعليقك" rows="5"></textarea>
                    <button id="submitCommentBtn" class="btn btn-primary" style="align-self: flex-start;">
                        <i class="fas fa-comment-medical"></i>
                        <span>إضافة تعليق</span>
                    </button>
                </div>
            </div>
        </section>
        
        <!-- Programmer Section -->
        <section id="programmer-section" class="content-section">
            <div class="programmer-section">
                <img src="https://cdn-icons-png.flaticon.com/512/4727/4727496.png" alt="لوجو O.Y.D.F" class="programmer-logo" id="programmerLogo2">
                <h3 class="programmer-title" id="programmerTitle2">O.Y.D.F للبرمجيات والتطوير</h3>
                <p class="programmer-description" id="programmerDescription2">
                    نظام إدارة محتوى متكامل (CMS) بتقنيات حديثة وعالية الأداء. يمكنك تعديل كل شيء في الموقع بشكل مباشر وسهل بعد تفعيل كود التعديل.
                </p>
                <div style="display: flex; gap: 20px; justify-content: center; flex-wrap: wrap; margin-top: 30px;">
                    <button class="btn btn-primary" onclick="openControlPanel()">
                        <i class="fas fa-cogs"></i>
                        <span>لوحة التحكم</span>
                    </button>
                    <button class="btn btn-secondary" onclick="activateEditMode()">
                        <i class="fas fa-edit"></i>
                        <span>تفعيل التعديل</span>
                    </button>
                </div>
            </div>
        </section>
        
        <!-- قسم المتجر الجديد -->
        <section id="store-section" class="content-section">
            <div class="section-header">
                <h2 class="section-title">متجر المؤسسة</h2>
                <p style="font-size: 1.2rem; color: var(--gray); max-width: 800px; margin: 20px auto;">
                    تصفح واطلب منتجاتنا مباشرة من المتجر
                </p>
            </div>
            
            <div class="store-section">
                <div class="store-products-grid" id="storeProductsGrid">
                    <!-- سيتم ملؤه ديناميكياً -->
                </div>
            </div>
        </section>
        
        <!-- قسم الموقع والمكان -->
        <section id="location-section" class="content-section">
            <div class="section-header">
                <h2 class="section-title">الموقع والمكان</h2>
                <p style="font-size: 1.2rem; color: var(--gray); max-width: 800px; margin: 20px auto;">
                    عنوان المؤسسة وطرق التواصل
                </p>
            </div>
            
            <div class="location-section" id="locationSectionContent">
                <!-- سيتم ملؤه ديناميكياً من لوحة التحكم -->
            </div>
        </section>
        
        <!-- Social Links Section -->
        <div class="social-section">
            <h3 class="social-title">للتواصل والاستفسار يرجى الدخول على التالي:</h3>
            <div class="social-grid" id="socialGrid">
                <a href="https://wa.me/9660536887221" class="social-icon whatsapp" target="_blank" data-link-type="whatsapp">
                    <i class="fab fa-whatsapp"></i>
                </a>
                <a href="tel:+9660540781362" class="social-icon phone" data-link-type="phone">
                    <i class="fas fa-phone"></i>
                </a>
                <a href="#" class="social-icon instagram" data-link-type="instagram">
                    <i class="fab fa-instagram"></i>
                </a>
                <a href="#" class="social-icon tiktok" data-link-type="tiktok">
                    <i class="fab fa-tiktok"></i>
                </a>
                <a href="#" class="social-icon snapchat" data-link-type="snapchat">
                    <i class="fab fa-snapchat"></i>
                </a>
                <a href="#" class="social-icon twitter" data-link-type="twitter">
                    <i class="fab fa-twitter"></i>
                </a>
                <a href="#" class="social-icon facebook" data-link-type="facebook">
                    <i class="fab fa-facebook"></i>
                </a>
                <a href="#" class="social-icon youtube" data-link-type="youtube">
                    <i class="fab fa-youtube"></i>
                </a>
                <a href="#" class="social-icon telegram" data-link-type="telegram">
                    <i class="fab fa-telegram"></i>
                </a>
            </div>
        </div>
    </main>
    
    <!-- Footer -->
    <footer class="main-footer">
        <div class="footer-content">
            <h3 class="footer-title">مؤسسة فايز القثامي للمقاولات</h3>
            <p style="color: #cbd5e1; margin-bottom: 30px; font-size: 1.1rem;">
                جميع أنواع ديكورات الجي آر سي - تصنيع وتركيب - واجهات خارجية - فلل - قصور - مساجد - فنادق
            </p>
            
            <div class="footer-contact">
                <div class="contact-item" onclick="window.open('tel:0568013363')">
                    <i class="fas fa-phone"></i>
                    <span>0568013363</span>
                </div>
                <div class="contact-item" onclick="window.open('tel:0530266199')">
                    <i class="fas fa-phone-alt"></i>
                    <span>0530266199</span>
                </div>
            </div>
            
            <div class="footer-info">
                <p>© 2024 جميع الحقوق محفوظة | المملكة العربية السعودية</p>
                <div class="saudi-flag">
                    <div class="flag-icon"></div>
                    <span>العملة: ريال سعودي</span>
                </div>
                <p style="margin-top: 20px;">تم التطوير بواسطة <strong style="color: var(--accent);">O.Y.D.F للبرمجيات والتطوير</strong></p>
            </div>
        </div>
    </footer>
    
    <!-- Fixed CTA Buttons -->
    <div class="fixed-cta-container">
        <a href="https://wa.me/9660536887221" class="fixed-cta whatsapp-cta" target="_blank" id="whatsappFixed">
            <i class="fab fa-whatsapp"></i>
        </a>
        <a href="tel:+9660540781362" class="fixed-cta call-cta" id="callFixed">
            <i class="fas fa-phone"></i>
        </a>
    </div>
    
    <!-- O.Y.D.F Control Panel -->
    <div class="control-panel-overlay" id="controlPanelOverlay">
        <div class="control-panel">
            <div class="panel-header">
                <div class="panel-title">
                    <i class="fas fa-cogs"></i>
                    <span>لوحة تحكم O.Y.D.F</span>
                </div>
                <button class="panel-close" id="panelCloseBtn">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            
            <div class="panel-body">
                <div class="panel-sidebar">
                    <div class="panel-tabs">
                        <div class="panel-tab active" data-tab="edit-site">
                            <i class="fas fa-edit"></i>
                            <span>تعديل الموقع</span>
                        </div>
                        <div class="panel-tab" data-tab="sections-manager">
                            <i class="fas fa-th-large"></i>
                            <span>إدارة الأقسام</span>
                        </div>
                        <div class="panel-tab" data-tab="store-manager">
                            <i class="fas fa-store"></i>
                            <span>إدارة المتجر</span>
                        </div>
                        <div class="panel-tab" data-tab="icons-manager">
                            <i class="fas fa-icons"></i>
                            <span>إدارة الأيقونات</span>
                        </div>
                        <div class="panel-tab" data-tab="templates-manager">
                            <i class="fas fa-layer-group"></i>
                            <span>إدارة القوالب</span>
                        </div>
                        <div class="panel-tab" data-tab="storage">
                            <i class="fas fa-database"></i>
                            <span>التخزين المتقدم</span>
                        </div>
                        <div class="panel-tab" data-tab="orders">
                            <i class="fas fa-shopping-cart"></i>
                            <span>الطلبات الواردة</span>
                        </div>
                        <div class="panel-tab" data-tab="location">
                            <i class="fas fa-map-marker-alt"></i>
                            <span>العنوان والموقع</span>
                        </div>
                        <div class="panel-tab" data-tab="monitor">
                            <i class="fas fa-eye"></i>
                            <span>المراقبة والزوار</span>
                        </div>
                        <div class="panel-tab" data-tab="security">
                            <i class="fas fa-shield-alt"></i>
                            <span>الأمان والإعدادات</span>
                        </div>
                        <div class="panel-tab" data-tab="change-code">
                            <i class="fas fa-key"></i>
                            <span>تغيير الكود السري</span>
                        </div>
                        <div class="panel-tab" data-tab="trash">
                            <i class="fas fa-trash"></i>
                            <span>سلة المهملات</span>
                        </div>
                        <div class="panel-tab" data-tab="odo-editor">
                            <i class="fas fa-paint-brush"></i>
                            <span>محرر O.Y.D.F</span>
                        </div>
                        <div class="panel-tab" data-tab="ui-customizer">
                            <i class="fas fa-sliders-h"></i>
                            <span>تخصيص الواجهة</span>
                        </div>
                        <div class="panel-tab" data-tab="media-manager">
                            <i class="fas fa-images"></i>
                            <span>مدير الوسائط</span>
                        </div>
                        <div class="panel-tab" data-tab="branding">
                            <i class="fas fa-trademark"></i>
                            <span>العلامة التجارية</span>
                        </div>
                        <div class="panel-tab" data-tab="themes-manager">
                            <i class="fas fa-palette"></i>
                            <span>الثيمات والقوالب</span>
                        </div>
                    </div>
                </div>
                
                <div class="panel-content">
                    <!-- Edit Site Tab -->
                    <div id="edit-site-tab" class="tab-content active">
                        <h3 style="color: var(--primary); margin-bottom: 30px; font-size: 2rem;">
                            <i class="fas fa-edit"></i> تعديل الموقع مباشرة
                        </h3>
                        
                        <div class="form-group">
                            <label class="form-label">كود تفعيل وضع التعديل (Odoo Mode)</label>
                            <input type="password" class="form-input" id="odoCodeInput" placeholder="أدخل الكود 2007">
                            <div class="btn-group">
                                <button class="btn btn-primary" id="activateOdoBtn">
                                    <i class="fas fa-play"></i>
                                    <span>تفعيل وضع التعديل</span>
                                </button>
                                <button class="btn btn-secondary" id="deactivateOdoBtn">
                                    <i class="fas fa-stop"></i>
                                    <span>إيقاف وضع التعديل</span>
                                </button>
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">رفع ملفات من جهازك</label>
                            <input type="file" class="form-input" id="fileUploadInput" multiple accept="image/*,video/*,.gif,.pdf,.doc,.docx">
                            <p style="color: var(--gray); margin-top: 10px; font-size: 1rem;">
                                يمكنك رفع الصور، الفيديوهات، GIF، الملفات، اللوجو من جهازك مباشرة
                            </p>
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">تغيير الألوان الرئيسية</label>
                            <div style="display: grid; grid-template-columns: repeat(auto-fill, minmax(150px, 1fr)); gap: 15px; margin-top: 15px;">
                                <input type="color" id="primaryColorPicker" value="#1a365d" style="width: 100%; height: 60px; border-radius: var(--radius); border: 3px solid #e2e8f0; cursor: pointer;">
                                <input type="color" id="secondaryColorPicker" value="#2d6a4f" style="width: 100%; height: 60px; border-radius: var(--radius); border: 3px solid #e2e8f0; cursor: pointer;">
                                <input type="color" id="accentColorPicker" value="#d4af37" style="width: 100%; height: 60px; border-radius: var(--radius); border: 3px solid #e2e8f0; cursor: pointer;">
                            </div>
                            <button class="btn btn-secondary" id="applyColorsBtn" style="margin-top: 20px;">
                                <i class="fas fa-palette"></i>
                                <span>تطبيق الألوان</span>
                            </button>
                        </div>
                    </div>
                    
                    <!-- إدارة الأقسام Tab -->
                    <div id="sections-manager-tab" class="tab-content">
                        <h3 style="color: var(--primary); margin-bottom: 30px; font-size: 2rem;">
                            <i class="fas fa-th-large"></i> إدارة الأقسام
                        </h3>
                        
                        <div class="sections-manager">
                            <div class="form-group">
                                <label class="form-label">إضافة قسم جديد</label>
                                <div style="display: flex; gap: 15px; align-items: center;">
                                    <input type="text" id="newSectionName" class="form-input" placeholder="اسم القسم الجديد" style="flex: 1;">
                                    <select id="newSectionIcon" class="form-select" style="width: 150px;">
                                        <option value="fa-home">منزل</option>
                                        <option value="fa-images">صور</option>
                                        <option value="fa-video">فيديو</option>
                                        <option value="fa-store">متجر</option>
                                        <option value="fa-map-marker-alt">موقع</option>
                                        <option value="fa-comments">دردشة</option>
                                        <option value="fa-calculator">آلة حاسبة</option>
                                    </select>
                                    <button class="btn btn-primary" id="addSectionBtn">
                                        <i class="fas fa-plus"></i>
                                        <span>إضافة</span>
                                    </button>
                                </div>
                            </div>
                            
                            <div class="form-group">
                                <label class="form-label">الأقسام الحالية</label>
                                <div class="sections-list" id="sectionsList">
                                    <!-- سيتم ملؤه ديناميكياً -->
                                </div>
                            </div>
                            
                            <div class="btn-group">
                                <button class="btn btn-success" id="showAllSectionsBtn">
                                    <i class="fas fa-eye"></i>
                                    <span>إظهار الكل</span>
                                </button>
                                <button class="btn btn-danger" id="hideAllSectionsBtn">
                                    <i class="fas fa-eye-slash"></i>
                                    <span>إخفاء الكل</span>
                                </button>
                                <button class="btn btn-secondary" id="reorderSectionsBtn">
                                    <i class="fas fa-sort"></i>
                                    <span>إعادة ترتيب</span>
                                </button>
                            </div>
                        </div>
                    </div>
                    
                    <!-- إدارة المتجر Tab -->
                    <div id="store-manager-tab" class="tab-content">
                        <h3 style="color: var(--primary); margin-bottom: 30px; font-size: 2rem;">
                            <i class="fas fa-store"></i> إدارة المتجر
                        </h3>
                        
                        <div class="form-group">
                            <label class="form-label">إضافة منتج جديد</label>
                            <div style="border: 2px dashed var(--info); border-radius: var(--radius); padding: 30px; background: #f8fafc;">
                                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-bottom: 20px;">
                                    <input type="text" class="form-input" id="storeProductTitle" placeholder="اسم المنتج">
                                    <input type="text" class="form-input" id="storeProductPrice" placeholder="السعر (مثال: 5,000 ر.س)">
                                </div>
                                
                                <textarea class="form-textarea" id="storeProductDescription" placeholder="وصف المنتج..." rows="3"></textarea>
                                
                                <div style="margin: 20px 0;">
                                    <label class="form-label">رفع صورة المنتج</label>
                                    <input type="file" id="storeProductImage" accept="image/*" class="form-input">
                                </div>
                                
                                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin: 20px 0;">
                                    <input type="text" class="form-input" id="storeWhatsappLink" placeholder="رابط الواتساب للطلب">
                                    <input type="text" class="form-input" id="storeInstagramLink" placeholder="رابط الانستجرام">
                                </div>
                                
                                <div class="btn-group">
                                    <button class="btn btn-primary" id="addStoreProductBtn">
                                        <i class="fas fa-plus"></i>
                                        <span>إضافة المنتج</span>
                                    </button>
                                    <button class="btn btn-secondary" id="clearStoreFormBtn">
                                        <i class="fas fa-trash"></i>
                                        <span>مسح النموذج</span>
                                    </button>
                                </div>
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">المنتجات الحالية</label>
                            <div id="storeProductsList" style="display: grid; grid-template-columns: repeat(auto-fill, minmax(300px, 1fr)); gap: 20px;">
                                <!-- سيتم ملؤه ديناميكياً -->
                            </div>
                        </div>
                    </div>
                    
                    <!-- إدارة الأيقونات Tab -->
                    <div id="icons-manager-tab" class="tab-content">
                        <h3 style="color: var(--primary); margin-bottom: 30px; font-size: 2rem;">
                            <i class="fas fa-icons"></i> إدارة الأيقونات
                        </h3>
                        
                        <div class="form-group">
                            <label class="form-label">تعديل الأيقونات الاجتماعية</label>
                            <div id="iconsList" style="display: grid; grid-template-columns: repeat(auto-fill, minmax(250px, 1fr)); gap: 15px;">
                                <!-- سيتم ملؤه ديناميكياً -->
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">إضافة أيقونة جديدة</label>
                            <div style="display: flex; gap: 15px; align-items: center;">
                                <select id="newIconType" class="form-select" style="width: 150px;">
                                    <option value="whatsapp">واتساب</option>
                                    <option value="phone">هاتف</option>
                                    <option value="instagram">انستجرام</option>
                                    <option value="facebook">فيسبوك</option>
                                    <option value="youtube">يوتيوب</option>
                                    <option value="twitter">تويتر</option>
                                    <option value="telegram">تليجرام</option>
                                </select>
                                <input type="text" id="newIconLink" class="form-input" placeholder="الرابط" style="flex: 1;">
                                <button class="btn btn-primary" id="addIconBtn">
                                    <i class="fas fa-plus"></i>
                                    <span>إضافة</span>
                                </button>
                            </div>
                        </div>
                    </div>
                    
                    <!-- التخزين المتقدم Tab - معدل -->
                    <div id="storage-tab" class="tab-content">
                        <h3 style="color: var(--primary); margin-bottom: 30px; font-size: 2rem;">
                            <i class="fas fa-database"></i> إدارة التخزين المتقدم
                        </h3>
                        
                        <div class="advanced-storage">
                            <div class="form-group">
                                <label class="form-label">ربط حسابات التخزين</label>
                                
                                <!-- Firebase -->
                                <div class="storage-provider">
                                    <i class="fas fa-database" style="font-size: 1.5rem; color: #FFCA28;"></i>
                                    <div style="flex: 1;">
                                        <strong>Firebase</strong>
                                        <p style="color: var(--gray); font-size: 0.9rem;">ربط حساب Firebase للتخزين السحابي</p>
                                    </div>
                                    <button class="btn btn-primary connect-storage-btn" data-storage="firebase">
                                        <i class="fas fa-plug"></i>
                                        <span>ربط</span>
                                    </button>
                                </div>
                                
                                <!-- Firebase Connection Form -->
                                <div class="storage-connection-form" id="firebase-form">
                                    <div class="form-group">
                                        <label class="form-label">API Key</label>
                                        <input type="text" class="form-input" id="firebase-api-key" placeholder="أدخل API Key">
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label">Auth Domain</label>
                                        <input type="text" class="form-input" id="firebase-auth-domain" placeholder="أدخل Auth Domain">
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label">Project ID</label>
                                        <input type="text" class="form-input" id="firebase-project-id" placeholder="أدخل Project ID">
                                    </div>
                                    <button class="btn btn-success" id="save-firebase-btn">
                                        <i class="fas fa-save"></i>
                                        <span>حفظ إعدادات Firebase</span>
                                    </button>
                                </div>
                                
                                <!-- Gmail / Google Drive -->
                                <div class="storage-provider">
                                    <i class="fab fa-google" style="font-size: 1.5rem; color: #4285F4;"></i>
                                    <div style="flex: 1;">
                                        <strong>Gmail / Google Drive</strong>
                                        <p style="color: var(--gray); font-size: 0.9rem;">ربط حساب جوجل للتخزين السحابي</p>
                                    </div>
                                    <button class="btn btn-primary connect-storage-btn" data-storage="gmail">
                                        <i class="fas fa-plug"></i>
                                        <span>ربط</span>
                                    </button>
                                </div>
                                
                                <!-- Gmail Connection Form -->
                                <div class="storage-connection-form" id="gmail-form">
                                    <div class="form-group">
                                        <label class="form-label">البريد الإلكتروني</label>
                                        <input type="email" class="form-input" id="gmail-email" placeholder="example@gmail.com">
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label">كلمة المرور</label>
                                        <input type="password" class="form-input" id="gmail-password" placeholder="أدخل كلمة المرور">
                                    </div>
                                    <button class="btn btn-success" id="save-gmail-btn">
                                        <i class="fas fa-save"></i>
                                        <span>حفظ إعدادات Gmail</span>
                                    </button>
                                </div>
                                
                                <!-- Telegram -->
                                <div class="storage-provider">
                                    <i class="fab fa-telegram" style="font-size: 1.5rem; color: #0088cc;"></i>
                                    <div style="flex: 1;">
                                        <strong>Telegram</strong>
                                        <p style="color: var(--gray); font-size: 0.9rem;">تخزين في قناة تليجرام</p>
                                    </div>
                                    <button class="btn btn-primary connect-storage-btn" data-storage="telegram">
                                        <i class="fas fa-plug"></i>
                                        <span>ربط</span>
                                    </button>
                                </div>
                                
                                <!-- Telegram Connection Form -->
                                <div class="storage-connection-form" id="telegram-form">
                                    <div class="form-group">
                                        <label class="form-label">معرف البوت</label>
                                        <input type="text" class="form-input" id="telegram-bot-token" placeholder="أدخل توكن البوت">
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label">معرف القناة</label>
                                        <input type="text" class="form-input" id="telegram-channel-id" placeholder="@channel_name">
                                    </div>
                                    <button class="btn btn-success" id="save-telegram-btn">
                                        <i class="fas fa-save"></i>
                                        <span>حفظ إعدادات Telegram</span>
                                    </button>
                                </div>
                                
                                <!-- Terabox -->
                                <div class="storage-provider">
                                    <i class="fas fa-box" style="font-size: 1.5rem; color: #3B82F6;"></i>
                                    <div style="flex: 1;">
                                        <strong>Terabox</strong>
                                        <p style="color: var(--gray); font-size: 0.9rem;">تخزين في تيرابوكس</p>
                                    </div>
                                    <button class="btn btn-primary connect-storage-btn" data-storage="terabox">
                                        <i class="fas fa-plug"></i>
                                        <span>ربط</span>
                                    </button>
                                </div>
                                
                                <!-- Terabox Connection Form -->
                                <div class="storage-connection-form" id="terabox-form">
                                    <div class="form-group">
                                        <label class="form-label">البريد الإلكتروني</label>
                                        <input type="email" class="form-input" id="terabox-email" placeholder="أدخل بريد Terabox">
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label">كلمة المرور</label>
                                        <input type="password" class="form-input" id="terabox-password" placeholder="أدخل كلمة المرور">
                                    </div>
                                    <button class="btn btn-success" id="save-terabox-btn">
                                        <i class="fas fa-save"></i>
                                        <span>حفظ إعدادات Terabox</span>
                                    </button>
                                </div>
                                
                                <!-- التخزين المحلي -->
                                <div class="storage-provider">
                                    <i class="fas fa-hdd" style="font-size: 1.5rem; color: var(--primary);"></i>
                                    <div style="flex: 1;">
                                        <strong>التخزين المحلي</strong>
                                        <p style="color: var(--gray); font-size: 0.9rem;">تخزين على جهازك الخاص</p>
                                    </div>
                                    <button class="btn btn-primary connect-storage-btn" data-storage="local">
                                        <i class="fas fa-plug"></i>
                                        <span>فتح مجلد التخزين</span>
                                    </button>
                                </div>
                                
                                <!-- Local Storage Info -->
                                <div class="storage-connection-form" id="local-form">
                                    <div class="form-group">
                                        <label class="form-label">المسار المحلي</label>
                                        <input type="text" class="form-input" id="local-path" placeholder="سيتم تخزين الملفات في المتصفح" readonly>
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label">حجم التخزين المتاح</label>
                                        <div id="local-storage-info" style="color: var(--success); font-weight: bold;">
                                            جاري التحقق...
                                        </div>
                                    </div>
                                    <button class="btn btn-success" id="clear-local-storage">
                                        <i class="fas fa-trash"></i>
                                        <span>مسح التخزين المحلي</span>
                                    </button>
                                </div>
                            </div>
                            
                            <div class="storage-grid">
                                <div class="storage-option firebase" data-storage="firebase">
                                    <div class="storage-icon">
                                        <i class="fas fa-database"></i>
                                    </div>
                                    <h4 style="color: var(--primary);">Firebase</h4>
                                    <p style="color: var(--gray);">تخزين سحابي مجاني</p>
                                    <button class="btn btn-primary connect-storage-btn" data-storage="firebase">
                                        <i class="fas fa-plug"></i>
                                        <span>اتصال</span>
                                    </button>
                                </div>
                                
                                <div class="storage-option google" data-storage="google">
                                    <div class="storage-icon">
                                        <i class="fab fa-google-drive"></i>
                                    </div>
                                    <h4 style="color: var(--primary);">Google Drive</h4>
                                    <p style="color: var(--gray);">تخزين جوجل درايف 15GB</p>
                                    <button class="btn btn-secondary connect-storage-btn" data-storage="google">
                                        <i class="fas fa-plug"></i>
                                        <span>اتصال</span>
                                    </button>
                                </div>
                                
                                <div class="storage-option icloud" data-storage="icloud">
                                    <div class="storage-icon">
                                        <i class="fab fa-apple"></i>
                                    </div>
                                    <h4 style="color: var(--primary);">iCloud</h4>
                                    <p style="color: var(--gray);">تخزين آيكلاود مجاني</p>
                                    <button class="btn btn-secondary connect-storage-btn" data-storage="icloud">
                                        <i class="fas fa-plug"></i>
                                        <span>اتصال</span>
                                    </button>
                                </div>
                                
                                <div class="storage-option local" data-storage="local">
                                    <div class="storage-icon">
                                        <i class="fas fa-hdd"></i>
                                    </div>
                                    <h4 style="color: var(--primary);">التخزين المحلي</h4>
                                    <p style="color: var(--gray);">حفظ على جهازك</p>
                                    <button class="btn btn-secondary connect-storage-btn" data-storage="local">
                                        <i class="fas fa-plug"></i>
                                        <span>فتح المجلد</span>
                                    </button>
                                </div>
                                
                                <div class="storage-option mega" data-storage="mega">
                                    <div class="storage-icon">
                                        <i class="fas fa-folder"></i>
                                    </div>
                                    <h4 style="color: var(--primary);">MEGA</h4>
                                    <p style="color: var(--gray);">تخزين ميجا 20GB</p>
                                    <button class="btn btn-secondary connect-storage-btn" data-storage="mega">
                                        <i class="fas fa-plug"></i>
                                        <span>اتصال</span>
                                    </button>
                                </div>
                                
                                <div class="storage-option terabox" data-storage="terabox">
                                    <div class="storage-icon">
                                        <i class="fas fa-box"></i>
                                    </div>
                                    <h4 style="color: var(--primary);">Terabox</h4>
                                    <p style="color: var(--gray);">تخزين تيرابوكس 1TB</p>
                                    <button class="btn btn-secondary connect-storage-btn" data-storage="terabox">
                                        <i class="fas fa-plug"></i>
                                        <span>اتصال</span>
                                    </button>
                                </div>
                            </div>
                            
                            <div class="btn-group" style="margin-top: 40px;">
                                <button class="btn btn-primary" id="syncAllStorageBtn">
                                    <i class="fas fa-sync"></i>
                                    <span>مزامنة جميع التخزينات</span>
                                </button>
                                <button class="btn btn-danger" id="disconnectAllStorageBtn">
                                    <i class="fas fa-unlink"></i>
                                    <span>فصل جميع التخزينات</span>
                                </button>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Location Tab -->
                    <div id="location-tab" class="tab-content">
                        <h3 style="color: var(--primary); margin-bottom: 30px; font-size: 2rem;">
                            <i class="fas fa-map-marker-alt"></i> العنوان والموقع GPS
                        </h3>
                        
                        <div class="form-group">
                            <label class="form-label">عرض قسم الموقع في القائمة</label>
                            <label style="display: flex; align-items: center; gap: 10px; cursor: pointer;">
                                <input type="checkbox" id="showLocationSectionCheckbox" class="form-checkbox">
                                <span>إظهار قسم الموقع في القائمة الرئيسية</span>
                            </label>
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">عنوان المؤسسة</label>
                            <input type="text" class="form-input" id="addressInput" placeholder="أدخل العنوان الكامل">
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">رابط GPS أو إحداثيات</label>
                            <input type="text" class="form-input" id="gpsInput" placeholder="https://maps.google.com/ أو 24.7136,46.6753">
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">رقم الهاتف</label>
                            <input type="text" class="form-input" id="phoneInput" placeholder="مثال: 0568013363">
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">رقم الواتساب</label>
                            <input type="text" class="form-input" id="whatsappInput" placeholder="مثال: 9660568013363">
                        </div>
                        
                        <div class="btn-group">
                            <button class="btn btn-primary" id="saveLocationBtn">
                                <i class="fas fa-save"></i>
                                <span>حفظ المعلومات</span>
                            </button>
                            <button class="btn btn-secondary" id="showLocationBtn">
                                <i class="fas fa-eye"></i>
                                <span>إظهار القسم في الموقع</span>
                            </button>
                            <button class="btn btn-secondary" id="hideLocationBtn">
                                <i class="fas fa-eye-slash"></i>
                                <span>إخفاء القسم من الموقع</span>
                            </button>
                        </div>
                    </div>
                    
                    <!-- Change Code Tab -->
                    <div id="change-code-tab" class="tab-content">
                        <h3 style="color: var(--primary); margin-bottom: 30px; font-size: 2rem;">
                            <i class="fas fa-key"></i> تغيير الكود السري
                        </h3>
                        
                        <div class="form-group">
                            <label class="form-label">الكود الحالي للتحكم (2004)</label>
                            <input type="password" class="form-input" id="currentCodeInput" value="2004" readonly>
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">الكود الجديد</label>
                            <input type="password" class="form-input" id="newCodeInput" placeholder="أدخل الكود الجديد">
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">تأكيد الكود الجديد</label>
                            <input type="password" class="form-input" id="confirmCodeInput" placeholder="أعد إدخال الكود الجديد">
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">كود التعديل الحالي (2007)</label>
                            <input type="password" class="form-input" id="currentEditCodeInput" value="2007" readonly>
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">كود التعديل الجديد</label>
                            <input type="password" class="form-input" id="newEditCodeInput" placeholder="أدخل كود التعديل الجديد">
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">تأكيد كود التعديل الجديد</label>
                            <input type="password" class="form-input" id="confirmEditCodeInput" placeholder="أعد إدخال كود التعديل الجديد">
                        </div>
                        
                        <button class="btn btn-primary" id="changeCodesBtn">
                            <i class="fas fa-key"></i>
                            <span>تغيير الأكواد</span>
                        </button>
                    </div>
                    
                    <!-- Odo Editor Tab - منظم -->
                    <div id="odo-editor-tab" class="tab-content">
                        <h3 style="color: var(--primary); margin-bottom: 30px; font-size: 2rem;">
                            <i class="fas fa-paint-brush"></i> محرر O.Y.D.F المتكامل
                        </h3>
                        
                        <div class="editor-tools-container">
                            <h4 style="color: var(--primary); margin-bottom: 20px; font-size: 1.5rem;">
                                <i class="fas fa-tools"></i> أدوات التعديل السريع
                            </h4>
                            
                            <div class="editor-tools-grid">
                                <div class="editor-tool" data-action="edit-text">
                                    <i class="fas fa-font" style="font-size: 2rem; color: var(--primary); margin-bottom: 10px;"></i>
                                    <h5>تعديل النصوص</h5>
                                    <p style="color: var(--gray); font-size: 0.9rem;">تعديل جميع النصوص في الموقع</p>
                                </div>
                                
                                <div class="editor-tool" data-action="edit-images">
                                    <i class="fas fa-image" style="font-size: 2rem; color: var(--info); margin-bottom: 10px;"></i>
                                    <h5>تعديل الصور</h5>
                                    <p style="color: var(--gray); font-size: 0.9rem;">استبدال الصور واللوجوهات</p>
                                </div>
                                
                                <div class="editor-tool" data-action="edit-links">
                                    <i class="fas fa-link" style="font-size: 2rem; color: var(--success); margin-bottom: 10px;"></i>
                                    <h5>تعديل الروابط</h5>
                                    <p style="color: var(--gray); font-size: 0.9rem;">تغيير روابط التواصل والوسائط</p>
                                </div>
                                
                                <div class="editor-tool" data-action="edit-colors">
                                    <i class="fas fa-palette" style="font-size: 2rem; color: var(--warning); margin-bottom: 10px;"></i>
                                    <h5>تعديل الألوان</h5>
                                    <p style="color: var(--gray); font-size: 0.9rem;">تغيير ألوان الموقع الرئيسية</p>
                                </div>
                                
                                <div class="editor-tool" data-action="add-elements">
                                    <i class="fas fa-plus-circle" style="font-size: 2rem; color: var(--secondary); margin-bottom: 10px;"></i>
                                    <h5>إضافة عناصر</h5>
                                    <p style="color: var(--gray); font-size: 0.9rem;">إضافة عناصر جديدة لأي قسم</p>
                                </div>
                                
                                <div class="editor-tool" data-action="rearrange">
                                    <i class="fas fa-arrows-alt" style="font-size: 2rem; color: var(--danger); margin-bottom: 10px;"></i>
                                    <h5>إعادة ترتيب</h5>
                                    <p style="color: var(--gray); font-size: 0.9rem;">سحب وإفلات العناصر</p>
                                </div>
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">تفعيل وضع التعديل المتقدم</label>
                            <div class="btn-group">
                                <button class="btn btn-primary" id="enterOdoModeBtn">
                                    <i class="fas fa-magic"></i>
                                    <span>دخول وضع التعديل المتقدم</span>
                                </button>
                                <button class="btn btn-danger" id="exitOdoModeBtn">
                                    <i class="fas fa-sign-out-alt"></i>
                                    <span>تسجيل الخروج من التعديل</span>
                                </button>
                            </div>
                        </div>
                        
                        <div class="btn-group">
                            <button class="btn btn-success" id="saveAllEditsBtn">
                                <i class="fas fa-save"></i>
                                <span>حفظ جميع التعديلات</span>
                            </button>
                            <button class="btn btn-danger" id="resetAllEditsBtn">
                                <i class="fas fa-trash-restore"></i>
                                <span>استعادة النسخة الأصلية</span>
                            </button>
                        </div>
                    </div>
                    
                    <!-- إدارة القوالب Tab -->
                    <div id="templates-manager-tab" class="tab-content">
                        <h3 style="color: var(--primary); margin-bottom: 30px; font-size: 2rem;">
                            <i class="fas fa-layer-group"></i> إدارة القوالب والتمبلت
                        </h3>
                        
                        <div class="form-group">
                            <label class="form-label">رفع قالب جديد من جهازك</label>
                            <div style="border: 2px dashed var(--info); border-radius: var(--radius); padding: 30px; text-align: center; background: #f8fafc;">
                                <input type="file" id="templateUploadInput" accept=".html,.css,.js,.zip" style="display: none;">
                                <button class="btn btn-primary" id="uploadTemplateBtn">
                                    <i class="fas fa-upload"></i>
                                    <span>اختر ملف القالب</span>
                                </button>
                                <p style="color: var(--gray); margin-top: 15px;">يدعم: HTML, CSS, JS, ملفات مضغوطة ZIP</p>
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">القوالب المتاحة</label>
                            <div class="themes-section" id="templatesList">
                                <!-- سيتم ملؤه ديناميكياً -->
                            </div>
                        </div>
                    </div>
                    
                    <!-- الثيمات والقوالب Tab - منظم -->
                    <div id="themes-manager-tab" class="tab-content">
                        <h3 style="color: var(--primary); margin-bottom: 30px; font-size: 2rem;">
                            <i class="fas fa-palette"></i> الثيمات والقوالب الجاهزة
                        </h3>
                        
                        <div class="editor-tools-container">
                            <h4 style="color: var(--primary); margin-bottom: 20px; font-size: 1.5rem;">
                                <i class="fas fa-star"></i> الثيمات المميزة
                            </h4>
                            
                            <div class="editor-tools-grid">
                                <div class="editor-tool" data-theme="professional">
                                    <div style="width: 100%; height: 80px; background: linear-gradient(135deg, var(--primary), var(--info)); border-radius: 10px; margin-bottom: 10px;"></div>
                                    <h5>ثيم احترافي</h5>
                                    <p style="color: var(--gray); font-size: 0.9rem;">مناسب للشركات</p>
                                </div>
                                
                                <div class="editor-tool" data-theme="modern">
                                    <div style="width: 100%; height: 80px; background: linear-gradient(135deg, #0f172a, #1e293b); border-radius: 10px; margin-bottom: 10px;"></div>
                                    <h5>ثيم عصري</h5>
                                    <p style="color: var(--gray); font-size: 0.9rem;">تصميم حديث</p>
                                </div>
                                
                                <div class="editor-tool" data-theme="minimal">
                                    <div style="width: 100%; height: 80px; background: linear-gradient(135deg, #f8fafc, #e2e8f0); border-radius: 10px; margin-bottom: 10px; border: 1px solid #cbd5e1;"></div>
                                    <h5>ثيم مينيمال</h5>
                                    <p style="color: var(--gray); font-size: 0.9rem;">بسيط وأنيق</p>
                                </div>
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">ثيمات 3D متقدمة</label>
                            <div class="themes-section">
                                <div class="theme-card" data-theme="3d-blue">
                                    <div class="theme-preview" style="background: linear-gradient(135deg, #1e3a8a, #3b82f6);"></div>
                                    <h4>ثيم 3D أزرق</h4>
                                    <p style="color: var(--gray);">تصميم ثلاثي الأبعاد بتدرجات زرقاء</p>
                                    <button class="btn btn-primary apply-theme-btn" data-theme="3d-blue">
                                        <i class="fas fa-check"></i>
                                        <span>تطبيق</span>
                                    </button>
                                </div>
                                
                                <div class="theme-card" data-theme="3d-green">
                                    <div class="theme-preview" style="background: linear-gradient(135deg, #065f46, #10b981);"></div>
                                    <h4>ثيم 3D أخضر</h4>
                                    <p style="color: var(--gray);">تصميم ثلاثي الأبعاد بتدرجات خضراء</p>
                                    <button class="btn btn-primary apply-theme-btn" data-theme="3d-green">
                                        <i class="fas fa-check"></i>
                                        <span>تطبيق</span>
                                    </button>
                                </div>
                                
                                <div class="theme-card" data-theme="3d-gold">
                                    <div class="theme-preview" style="background: linear-gradient(135deg, #92400e, #d97706);"></div>
                                    <h4>ثيم 3D ذهبي</h4>
                                    <p style="color: var(--gray);">تصميم فاخر بتدرجات ذهبية</p>
                                    <button class="btn btn-primary apply-theme-btn" data-theme="3d-gold">
                                        <i class="fas fa-check"></i>
                                        <span>تطبيق</span>
                                    </button>
                                </div>
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">قوالب جاهزة</label>
                            <div class="themes-section">
                                <div class="theme-card" data-template="modern">
                                    <div class="theme-preview" style="background: linear-gradient(135deg, #1e293b, #475569);"></div>
                                    <h4>قالب عصري</h4>
                                    <p style="color: var(--gray);">تصميم عصري مع تأثيرات متطورة</p>
                                    <div style="display: flex; gap: 10px; margin-top: 10px;">
                                        <button class="btn btn-primary apply-template-btn" data-template="modern">
                                            <i class="fas fa-check"></i>
                                            <span>تطبيق</span>
                                        </button>
                                        <button class="btn btn-danger delete-template-btn" data-template="modern">
                                            <i class="fas fa-trash"></i>
                                        </button>
                                    </div>
                                </div>
                                
                                <div class="theme-card" data-template="classic">
                                    <div class="theme-preview" style="background: linear-gradient(135deg, #78350f, #d97706);"></div>
                                    <h4>قالب كلاسيكي</h4>
                                    <p style="color: var(--gray);">تصميم تقليدي أنيق</p>
                                    <div style="display: flex; gap: 10px; margin-top: 10px;">
                                        <button class="btn btn-primary apply-template-btn" data-template="classic">
                                            <i class="fas fa-check"></i>
                                            <span>تطبيق</span>
                                        </button>
                                        <button class="btn btn-danger delete-template-btn" data-template="classic">
                                            <i class="fas fa-trash"></i>
                                        </button>
                                    </div>
                                </div>
                                
                                <div class="theme-card" data-template="minimal">
                                    <div class="theme-preview" style="background: linear-gradient(135deg, #374151, #6b7280);"></div>
                                    <h4>قالب مينيمال</h4>
                                    <p style="color: var(--gray);">تصميم بسيط وأنيق</p>
                                    <div style="display: flex; gap: 10px; margin-top: 10px;">
                                        <button class="btn btn-primary apply-template-btn" data-template="minimal">
                                            <i class="fas fa-check"></i>
                                            <span>تطبيق</span>
                                        </button>
                                        <button class="btn btn-danger delete-template-btn" data-template="minimal">
                                            <i class="fas fa-trash"></i>
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- UI Customizer Tab -->
                    <div id="ui-customizer-tab" class="tab-content">
                        <h3 style="color: var(--primary); margin-bottom: 30px; font-size: 2rem;">
                            <i class="fas fa-sliders-h"></i> تخصيص الواجهة
                        </h3>
                        
                        <div class="form-group">
                            <label class="form-label">حجم الشريط العلوي</label>
                            <div style="display: grid; grid-template-columns: repeat(auto-fill, minmax(180px, 1fr)); gap: 15px; margin-top: 15px;">
                                <button class="btn btn-secondary header-size-btn" data-size="small">
                                    <i class="fas fa-compress"></i>
                                    <span>رفيع</span>
                                </button>
                                <button class="btn btn-secondary header-size-btn" data-size="medium">
                                    <i class="fas fa-square"></i>
                                    <span>وسط</span>
                                </button>
                                <button class="btn btn-secondary header-size-btn" data-size="large">
                                    <i class="fas fa-expand"></i>
                                    <span>عريض</span>
                                </button>
                                <button class="btn btn-danger header-size-btn" data-size="hidden">
                                    <i class="fas fa-eye-slash"></i>
                                    <span>إخفاء</span>
                                </button>
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">حجم شريط الأقسام</label>
                            <div style="display: grid; grid-template-columns: repeat(auto-fill, minmax(180px, 1fr)); gap: 15px; margin-top: 15px;">
                                <button class="btn btn-secondary sidebar-size-btn" data-size="small">
                                    <i class="fas fa-columns"></i>
                                    <span>صغير (250px)</span>
                                </button>
                                <button class="btn btn-secondary sidebar-size-btn active" data-size="medium">
                                    <i class="fas fa-columns"></i>
                                    <span>متوسط (320px)</span>
                                </button>
                                <button class="btn btn-secondary sidebar-size-btn" data-size="large">
                                    <i class="fas fa-columns"></i>
                                    <span>كبير (400px)</span>
                                </button>
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">خيارات التمرير</label>
                            <div style="display: flex; flex-direction: column; gap: 15px; margin-top: 15px;">
                                <label style="display: flex; align-items: center; gap: 10px; cursor: pointer;">
                                    <input type="checkbox" id="hiddenScrollCheckbox" class="form-checkbox">
                                    <span>تفعيل التمرير المخفي (Hidden Scroll)</span>
                                </label>
                                <label style="display: flex; align-items: center; gap: 10px; cursor: pointer;">
                                    <input type="checkbox" id="smoothScrollCheckbox" class="form-checkbox" checked>
                                    <span>تفعيل التمرير السلس (Smooth Scroll)</span>
                                </label>
                            </div>
                        </div>
                        
                        <button class="btn btn-primary" id="applyUISettingsBtn">
                            <i class="fas fa-check"></i>
                            <span>تطبيق التخصيصات</span>
                        </button>
                    </div>
                    
                    <!-- Media Manager Tab -->
                    <div id="media-manager-tab" class="tab-content">
                        <h3 style="color: var(--primary); margin-bottom: 30px; font-size: 2rem;">
                            <i class="fas fa-images"></i> مدير الوسائط
                        </h3>
                        
                        <div class="form-group">
                            <label class="form-label">رفع وسائط جديدة</label>
                            <div style="border: 2px dashed var(--info); border-radius: var(--radius); padding: 40px; text-align: center; background: #f8fafc; margin-bottom: 30px;">
                                <input type="file" id="mediaUploadInput" multiple accept="image/*,video/*,.gif,.mp4,.webm" 
                                       style="display: none;">
                                <div id="mediaDropZone" style="cursor: pointer;">
                                    <i class="fas fa-cloud-upload-alt" style="font-size: 4rem; color: var(--info); margin-bottom: 20px;"></i>
                                    <h4 style="color: var(--primary); margin-bottom: 10px;">اسحب وأفلت الملفات هنا</h4>
                                    <p style="color: var(--gray); margin-bottom: 20px;">أو انقر لاختيار الملفات</p>
                                    <button class="btn btn-secondary" id="selectMediaBtn">
                                        <i class="fas fa-folder-open"></i>
                                        <span>اختر الملفات</span>
                                    </button>
                                </div>
                                <p style="color: var(--gray); margin-top: 20px; font-size: 0.9rem;">
                                    يدعم: الصور (JPG, PNG, GIF)، الفيديوهات (MP4, WebM)، الرسوم المتحركة
                                </p>
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">تفاصيل الوسائط</label>
                            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
                                <div>
                                    <input type="text" class="form-input" id="mediaTitle" placeholder="عنوان المنتج">
                                </div>
                                <div>
                                    <input type="text" class="form-input" id="mediaPrice" placeholder="السعر (مثال: 5,000 ر.س)">
                                </div>
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">وصف المنتج</label>
                            <textarea class="form-textarea" id="mediaDescription" placeholder="أدخل وصف تفصيلي للمنتج..." rows="4"></textarea>
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">القسم المستهدف</label>
                            <div style="display: grid; grid-template-columns: repeat(auto-fill, minmax(200px, 1fr)); gap: 15px; margin-top: 15px;">
                                <label style="display: flex; align-items: center; gap: 10px; cursor: pointer;">
                                    <input type="checkbox" name="mediaSection" value="home" class="form-checkbox" checked>
                                    <span>الرئيسية</span>
                                </label>
                                <label style="display: flex; align-items: center; gap: 10px; cursor: pointer;">
                                    <input type="checkbox" name="mediaSection" value="products" class="form-checkbox">
                                    <span>معرض المنتجات</span>
                                </label>
                                <label style="display: flex; align-items: center; gap: 10px; cursor: pointer;">
                                    <input type="checkbox" name="mediaSection" value="videos" class="form-checkbox">
                                    <span>فيديوهات المنتجات</span>
                                </label>
                                <label style="display: flex; align-items: center; gap: 10px; cursor: pointer;">
                                    <input type="checkbox" name="mediaSection" value="store" class="form-checkbox">
                                    <span>المتجر</span>
                                </label>
                            </div>
                        </div>
                        
                        <div class="btn-group">
                            <button class="btn btn-primary" id="uploadMediaBtn">
                                <i class="fas fa-upload"></i>
                                <span>رفع وإضافة</span>
                            </button>
                            <button class="btn btn-secondary" id="previewMediaBtn">
                                <i class="fas fa-eye"></i>
                                <span>معاينة</span>
                            </button>
                            <button class="btn btn-danger" id="clearMediaFormBtn">
                                <i class="fas fa-trash"></i>
                                <span>مسح النموذج</span>
                            </button>
                        </div>
                        
                        <div id="uploadedMediaList" style="margin-top: 40px;">
                            <h4 style="color: var(--primary); margin-bottom: 20px;">
                                <i class="fas fa-list"></i> الوسائط المرفوعة حديثاً
                            </h4>
                            <div id="mediaListContainer" style="display: grid; grid-template-columns: repeat(auto-fill, minmax(200px, 1fr)); gap: 15px;">
                                <!-- سيتم ملؤه ديناميكياً -->
                            </div>
                        </div>
                    </div>
                    
                    <!-- Branding Tab -->
                    <div id="branding-tab" class="tab-content">
                        <h3 style="color: var(--primary); margin-bottom: 30px; font-size: 2rem;">
                            <i class="fas fa-trademark"></i> العلامة التجارية
                        </h3>
                        
                        <div class="form-group">
                            <label class="form-label">اسم المؤسسة</label>
                            <input type="text" class="form-input" id="brandNameInput" value="مؤسسة فايز القثامي للمقاولات">
                            <p style="color: var(--gray); margin-top: 10px; font-size: 1rem;">
                                سيتم عرض هذا الاسم في الشريط العلوي وجميع أقسام الموقع
                            </p>
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">وصف المؤسسة</label>
                            <textarea class="form-textarea" id="brandDescriptionInput" rows="3">تصنيع وتوريد وتركيب الجي آر سي</textarea>
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">اسم المبرمج</label>
                            <input type="text" class="form-input" id="programmerNameInput" value="O.Y.D.F للبرمجيات والتطوير">
                            <p style="color: var(--gray); margin-top: 10px; font-size: 1rem;">
                                سيتم عرض هذا الاسم في قسم المبرمج بالموقع
                            </p>
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">وصف المبرمج</label>
                            <textarea class="form-textarea" id="programmerDescriptionInput" rows="3">نظام إدارة محتوى متكامل (CMS) بتقنيات حديثة وعالية الأداء. يمكنك تعديل كل شيء في الموقع بشكل مباشر وسهل بعد تفعيل كود التعديل.</textarea>
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">تغيير اللوجو (الصورة)</label>
                            <div style="display: flex; flex-direction: column; gap: 20px;">
                                <div style="display: flex; align-items: center; gap: 30px; flex-wrap: wrap;">
                                    <img src="https://cdn-icons-png.flaticon.com/512/2206/2206633.png" alt="اللوجو الحالي" 
                                         id="currentLogoPreview" style="width: 100px; height: 100px; border-radius: 50%; border: 3px solid var(--accent); padding: 5px; background: white;">
                                    <div>
                                        <p style="color: var(--gray); margin-bottom: 10px;">اللوجو الحالي</p>
                                        <input type="file" id="logoUploadInput" accept="image/*" style="display: none;">
                                        <button class="btn btn-secondary" id="changeLogoBtn">
                                            <i class="fas fa-image"></i>
                                            <span>تغيير اللوجو</span>
                                        </button>
                                    </div>
                                </div>
                                
                                <div>
                                    <p style="color: var(--gray); margin-bottom: 10px;">أو أدخل رابط صورة من الإنترنت:</p>
                                    <input type="url" class="form-input" id="logoUrlInput" placeholder="https://example.com/logo.png">
                                </div>
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">لوجو O.Y.D.F (المبرمج)</label>
                            <div style="display: flex; align-items: center; gap: 30px; flex-wrap: wrap;">
                                <img src="https://cdn-icons-png.flaticon.com/512/4727/4727496.png" alt="لوجو O.Y.D.F" 
                                     id="currentOydfLogoPreview" style="width: 100px; height: 100px; border-radius: 50%; border: 3px solid var(--accent); padding: 10px; background: white;">
                                <div>
                                    <p style="color: var(--gray); margin-bottom: 10px;">لوجو نظام O.Y.D.F</p>
                                    <input type="file" id="oydflogoUploadInput" accept="image/*" style="display: none;">
                                    <button class="btn btn-secondary" id="changeOydfLogoBtn">
                                        <i class="fas fa-code"></i>
                                        <span>تغيير اللوجو</span>
                                    </button>
                                </div>
                            </div>
                        </div>
                        
                        <div class="btn-group">
                            <button class="btn btn-primary" id="saveBrandingBtn">
                                <i class="fas fa-save"></i>
                                <span>حفظ التغييرات</span>
                            </button>
                            <button class="btn btn-secondary" id="resetBrandingBtn">
                                <i class="fas fa-undo"></i>
                                <span>استعادة الإعدادات الافتراضية</span>
                            </button>
                            <button class="btn btn-success" id="previewBrandingBtn">
                                <i class="fas fa-eye"></i>
                                <span>معاينة التغييرات</span>
                            </button>
                        </div>
                    </div>
                    
                    <!-- Trash Tab -->
                    <div id="trash-tab" class="tab-content">
                        <h3 style="color: var(--primary); margin-bottom: 30px; font-size: 2rem;">
                            <i class="fas fa-trash"></i> سلة المهملات
                        </h3>
                        
                        <div class="form-group">
                            <label class="form-label">العناصر المحذوفة</label>
                            <div id="trashItemsList" style="display: flex; flex-direction: column; gap: 15px;">
                                <!-- سيتم ملؤه ديناميكياً -->
                            </div>
                        </div>
                        
                        <div class="btn-group">
                            <button class="btn btn-success" id="restoreAllTrashBtn">
                                <i class="fas fa-trash-restore"></i>
                                <span>استعادة الكل</span>
                            </button>
                            <button class="btn btn-danger" id="emptyTrashBtn">
                                <i class="fas fa-trash"></i>
                                <span>تفريغ سلة المهملات</span>
                            </button>
                        </div>
                    </div>
                    
                    <!-- Other tabs content would continue here -->
                </div>
            </div>
        </div>
    </div>
    
    <!-- System Core Script -->
    <script>
        // ======================
        // GLOBAL CONFIGURATION
        // ======================
        const CONFIG = {
            FIREBASE: {
                apiKey: "AIzaSyBP_SlDFQfuZJzAUGTzSoY65vesp4LGsxg",
                authDomain: "fayez-al-qathami.firebaseapp.com",
                projectId: "fayez-al-qathami",
                storageBucket: "fayez-al-qathami.firebasestorage.app",
                messagingSenderId: "31116445128",
                appId: "1:31116445128:web:b355d010069f1e86052cfd",
                databaseURL: "https://fayez-al-qathami-default-rtdb.firebaseio.com/"
            },
            MASTER_CODE: "2004",
            EDIT_CODE: "2007",
            IS_EDIT_MODE: false,
            DEFAULT_DATA: {
                products: [
                    {
                        id: 1,
                        type: "product",
                        title: "واجهة فيلا كلاسيكية",
                        description: "تصميم فاخر لواجهات الفلل باستخدام أحدث تقنيات الجي آر سي مع ضمان 10 سنوات.",
                        price: "5,000 ر.س",
                        media: "https://images.unsplash.com/photo-1618220179428-22790b461013?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=80",
                        category: "واجهات"
                    },
                    {
                        id: 2,
                        type: "product",
                        title: "ديكور مسجد",
                        description: "تصميمات إسلامية فاخرة للمساجد والقباب بأعلى معايير الجودة والدقة.",
                        price: "15,000 ر.س",
                        media: "https://images.unsplash.com/photo-1586023492125-27b2c045efd7?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=80",
                        category: "مساجد"
                    },
                    {
                        id: 3,
                        type: "product",
                        title: "واجهة فندق",
                        description: "تصميم عصري لواجهات الفنادق والمجمعات التجارية بمقاومة عالية للعوامل الجوية.",
                        price: "25,000 ر.س",
                        media: "https://images.unsplash.com/photo-1567496898669-ee935f003f30?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=80",
                        category: "فنادق"
                    },
                    {
                        id: 4,
                        type: "video",
                        title: "فيديو توضيحي للمنتجات",
                        description: "مقطع فيديو يوضح عملية تصنيع وتوريد ديكورات الجي آر سي.",
                        price: "مجاني",
                        media: "https://assets.mixkit.co/videos/preview/mixkit-manufacturing-process-of-factory-machinery-41530-large.mp4",
                        category: "فيديوهات"
                    },
                    {
                        id: 5,
                        type: "product",
                        title: "أعمدة ديكورية",
                        description: "أعمدة جي آر سي ديكورية بتصاميم كلاسيكية وعصرية.",
                        price: "3,500 ر.س",
                        media: "https://images.unsplash.com/photo-1558618666-fcd25c85cd64?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=80",
                        category: "ديكور"
                    },
                    {
                        id: 6,
                        type: "product",
                        title: "شلالات صناعية",
                        description: "تصميمات شلالات صناعية بديكورات جي آر سي فاخرة.",
                        price: "12,000 ر.س",
                        media: "https://images.unsplash.com/photo-1519690889869-e705e59f72e1?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=80",
                        category: "ديكور خارجي"
                    }
                ],
                socialLinks: [
                    { type: "whatsapp", url: "https://wa.me/9660536887221", icon: "fab fa-whatsapp" },
                    { type: "phone", url: "tel:+9660540781362", icon: "fas fa-phone" },
                    { type: "instagram", url: "#", icon: "fab fa-instagram" },
                    { type: "tiktok", url: "#", icon: "fab fa-tiktok" },
                    { type: "snapchat", url: "#", icon: "fab fa-snapchat" },
                    { type: "twitter", url: "#", icon: "fab fa-twitter" },
                    { type: "facebook", url: "#", icon: "fab fa-facebook" },
                    { type: "youtube", url: "#", icon: "fab fa-youtube" },
                    { type: "telegram", url: "#", icon: "fab fa-telegram" }
                ]
            }
        };

        // ======================
        // GLOBAL STATE
        // ======================
        const STATE = {
            isOdoMode: false,
            isControlPanelOpen: false,
            currentUser: null,
            currentSection: "home",
            activeStorage: "firebase",
            currentTheme: "light",
            brightness: 100,
            headerSize: "medium",
            sidebarSize: "medium",
            hiddenScroll: false,
            smoothScroll: true,
            edits: {},
            trash: [],
            visitors: [],
            orders: [],
            comments: [],
            uploadedMedia: [],
            sections: [],
            storeProducts: [],
            templates: [],
            pendingMediaFiles: [],
            newLogoFile: null,
            newOydfLogoFile: null,
            isSettingsHidden: false,
            editModeActive: false,
            storageConnections: {
                firebase: { connected: true, config: CONFIG.FIREBASE },
                gmail: { connected: false, email: "", password: "" },
                telegram: { connected: false, botToken: "", channelId: "" },
                terabox: { connected: false, email: "", password: "" },
                local: { connected: true, path: "localStorage" }
            }
        };

        // ======================
        // FIREBASE INITIALIZATION
        // ======================
        let firebaseApp, firestore, firebaseStorage, firebaseAuth, realtimeDB, analytics;
        
        try {
            firebaseApp = firebase.initializeApp(CONFIG.FIREBASE);
            firestore = firebase.firestore();
            firebaseStorage = firebase.storage();
            firebaseAuth = firebase.auth();
            realtimeDB = firebase.database();
            analytics = firebase.analytics();
            
            console.log("✅ Firebase initialized successfully");
        } catch (error) {
            console.error("❌ Firebase initialization error:", error);
        }

        // ======================
        // MAIN APPLICATION OBJECT
        // ======================
        const App = {
            // Initialize the application
            init() {
                this.hideLoading();
                this.setupEventListeners();
                this.loadInitialData();
                this.initScrollReveal();
                this.setupFirebaseListeners();
                this.setupAutoSave();
                this.setupVisitorTracking();
                this.loadUIsettings();
                this.initializeFirebaseReferences();
                this.setupEditSectionDropdown();
            },
            
            // تهيئة مراجع Firebase
            initializeFirebaseReferences() {
                if (!firestore) return;
                
                // مراجع لقواعد البيانات الجديدة
                this.firebaseRefs = {
                    sections: firestore.collection("sections"),
                    trash: firestore.collection("trash"),
                    orders: firestore.collection("orders"),
                    storeProducts: firestore.collection("store_products"),
                    templates: firestore.collection("templates"),
                    inbox: firestore.collection("inbox"),
                    storageConnections: firestore.collection("storage_connections")
                };
            },
            
            // Hide loading screen
            hideLoading() {
                setTimeout(() => {
                    document.getElementById('loadingScreen').classList.add('hidden');
                }, 1500);
            },
            
            // Setup all event listeners
            setupEventListeners() {
                // Menu toggle
                document.getElementById('menuToggle').addEventListener('click', () => {
                    document.getElementById('navSidebar').classList.toggle('active');
                });
                
                // Navigation sections
                document.querySelectorAll('.nav-section-item').forEach(item => {
                    item.addEventListener('click', () => {
                        const section = item.getAttribute('data-section');
                        this.switchSection(section);
                        document.getElementById('navSidebar').classList.remove('active');
                    });
                });
                
                // Hidden key button (control panel)
                document.getElementById('hiddenKeyBtn').addEventListener('click', () => {
                    this.promptForCode(CONFIG.MASTER_CODE, this.openControlPanel.bind(this), "لوحة التحكم");
                });
                
                // Control panel close
                document.getElementById('panelCloseBtn').addEventListener('click', () => {
                    this.closeControlPanel();
                });
                
                // Panel tabs
                document.querySelectorAll('.panel-tab').forEach(tab => {
                    tab.addEventListener('click', () => {
                        const tabId = tab.getAttribute('data-tab');
                        this.switchPanelTab(tabId);
                    });
                });
                
                // Odo Mode Floating Buttons
                document.getElementById('saveOdoBtn').addEventListener('click', () => {
                    this.saveAllEditsToFirebase();
                });
                
                document.getElementById('exitOdoBtn').addEventListener('click', () => {
                    this.logoutAndLock();
                });
                
                // زر تعديل القسم الجديد
                document.getElementById('sectionEditBtn').addEventListener('click', (e) => {
                    this.toggleEditSectionDropdown(e);
                });
                
                // زر تعديل قسم رئيسي
                document.getElementById('editSectionMainBtn').addEventListener('click', () => {
                    this.activateEditModeForCurrentSection();
                });
                
                // زر العودة للتعديل
                document.getElementById('backToEditBtn').addEventListener('click', () => {
                    this.showAddTemplateMenu();
                });
                
                // زر إخفاء قائمة الإعدادات
                document.getElementById('hideSettingsBtn').addEventListener('click', () => {
                    this.toggleSettingsVisibility();
                });
                
                // زر العين فوق زر الحفظ
                document.getElementById('eyeAboveSaveBtn').addEventListener('click', () => {
                    this.toggleElementVisibility();
                });
                
                // Activate Odo mode
                document.getElementById('activateOdoBtn').addEventListener('click', () => {
                    const code = document.getElementById('odoCodeInput').value;
                    if (code === CONFIG.EDIT_CODE) {
                        this.activateOdoMode();
                        this.showNotification('تم تفعيل وضع التعديل', 'success');
                    } else {
                        this.showNotification('كود غير صحيح', 'error');
                    }
                });
                
                // Deactivate Odo mode
                document.getElementById('deactivateOdoBtn').addEventListener('click', () => {
                    this.logoutAndLock();
                });
                
                // Floating Plus Button
                document.getElementById('floatingPlus').addEventListener('click', (e) => {
                    this.showAddTemplateMenu(e.clientX, e.clientY);
                });
                
                // Eye Toggle Button
                document.getElementById('eyeToggleBtn').addEventListener('click', () => {
                    this.toggleElementVisibility();
                });
                
                // File upload
                document.getElementById('fileUploadInput').addEventListener('change', (e) => {
                    this.handleFileUpload(e.target.files);
                });
                
                // Save location
                document.getElementById('saveLocationBtn').addEventListener('click', () => {
                    this.saveLocationData();
                });
                
                // Show/hide location section
                document.getElementById('showLocationSectionCheckbox').addEventListener('change', (e) => {
                    this.toggleLocationSection(e.target.checked);
                });
                
                // Change codes
                document.getElementById('changeCodesBtn').addEventListener('click', () => {
                    this.changeMasterCodes();
                });
                
                // Enter Odo mode from editor tab
                document.getElementById('enterOdoModeBtn').addEventListener('click', () => {
                    this.promptForCode(CONFIG.EDIT_CODE, this.activateOdoMode.bind(this), "وضع التعديل المتقدم");
                });
                
                // Exit Odo mode from editor tab
                document.getElementById('exitOdoModeBtn').addEventListener('click', () => {
                    this.logoutAndLock();
                });
                
                // Save all edits
                document.getElementById('saveAllEditsBtn').addEventListener('click', () => {
                    this.saveAllEdits();
                });
                
                // Reset all edits
                document.getElementById('resetAllEditsBtn').addEventListener('click', () => {
                    this.resetAllEdits();
                });
                
                // Connect storage buttons
                document.querySelectorAll('.connect-storage-btn').forEach(btn => {
                    btn.addEventListener('click', (e) => {
                        const storageType = e.currentTarget.getAttribute('data-storage');
                        this.showStorageConnectionForm(storageType);
                    });
                });
                
                // Save Firebase connection
                document.getElementById('save-firebase-btn')?.addEventListener('click', () => {
                    this.saveFirebaseConnection();
                });
                
                // Save Gmail connection
                document.getElementById('save-gmail-btn')?.addEventListener('click', () => {
                    this.saveGmailConnection();
                });
                
                // Save Telegram connection
                document.getElementById('save-telegram-btn')?.addEventListener('click', () => {
                    this.saveTelegramConnection();
                });
                
                // Save Terabox connection
                document.getElementById('save-terabox-btn')?.addEventListener('click', () => {
                    this.saveTeraboxConnection();
                });
                
                // Clear local storage
                document.getElementById('clear-local-storage')?.addEventListener('click', () => {
                    this.clearLocalStorage();
                });
                
                // Sync all storage
                document.getElementById('syncAllStorageBtn').addEventListener('click', () => {
                    this.syncAllStorage();
                });
                
                // Disconnect all storage
                document.getElementById('disconnectAllStorageBtn').addEventListener('click', () => {
                    this.disconnectAllStorage();
                });
                
                // Submit comment
                document.getElementById('submitCommentBtn').addEventListener('click', () => {
                    this.submitComment();
                });
                
                // Color pickers
                document.getElementById('applyColorsBtn').addEventListener('click', () => {
                    this.applyCustomColors();
                });
                
                // Search functionality
                document.getElementById('siteSearch').addEventListener('input', (e) => {
                    this.handleSearch(e.target.value);
                });
                
                // UI Customizer
                document.querySelectorAll('.header-size-btn').forEach(btn => {
                    btn.addEventListener('click', (e) => {
                        const size = e.currentTarget.getAttribute('data-size');
                        this.changeHeaderSize(size);
                    });
                });
                
                document.querySelectorAll('.sidebar-size-btn').forEach(btn => {
                    btn.addEventListener('click', (e) => {
                        const size = e.currentTarget.getAttribute('data-size');
                        this.changeSidebarSize(size);
                    });
                });
                
                document.getElementById('hiddenScrollCheckbox').addEventListener('change', (e) => {
                    this.toggleHiddenScroll(e.target.checked);
                });
                
                document.getElementById('smoothScrollCheckbox').addEventListener('change', (e) => {
                    this.toggleSmoothScroll(e.target.checked);
                });
                
                document.getElementById('applyUISettingsBtn').addEventListener('click', () => {
                    this.applyUISettings();
                });
                
                // Media Manager
                document.getElementById('selectMediaBtn').addEventListener('click', () => {
                    document.getElementById('mediaUploadInput').click();
                });
                
                document.getElementById('mediaDropZone').addEventListener('click', () => {
                    document.getElementById('mediaUploadInput').click();
                });
                
                document.getElementById('mediaUploadInput').addEventListener('change', (e) => {
                    this.previewMediaFiles(e.target.files);
                });
                
                document.getElementById('uploadMediaBtn').addEventListener('click', () => {
                    this.uploadMediaFiles();
                });
                
                document.getElementById('previewMediaBtn').addEventListener('click', () => {
                    this.previewMediaProduct();
                });
                
                document.getElementById('clearMediaFormBtn').addEventListener('click', () => {
                    this.clearMediaForm();
                });
                
                // Branding
                document.getElementById('changeLogoBtn').addEventListener('click', () => {
                    document.getElementById('logoUploadInput').click();
                });
                
                document.getElementById('logoUploadInput').addEventListener('change', (e) => {
                    this.previewLogo(e.target.files[0], 'currentLogoPreview');
                });
                
                document.getElementById('changeOydfLogoBtn').addEventListener('click', () => {
                    document.getElementById('oydflogoUploadInput').click();
                });
                
                document.getElementById('oydflogoUploadInput').addEventListener('change', (e) => {
                    this.previewLogo(e.target.files[0], 'currentOydfLogoPreview');
                });
                
                document.getElementById('saveBrandingBtn').addEventListener('click', () => {
                    this.saveBranding();
                });
                
                document.getElementById('resetBrandingBtn').addEventListener('click', () => {
                    this.resetBranding();
                });
                
                document.getElementById('previewBrandingBtn').addEventListener('click', () => {
                    this.previewBranding();
                });
                
                // إدارة الأقسام
                document.getElementById('addSectionBtn').addEventListener('click', () => {
                    this.addNewSection();
                });
                
                document.getElementById('showAllSectionsBtn').addEventListener('click', () => {
                    this.showAllSections();
                });
                
                document.getElementById('hideAllSectionsBtn').addEventListener('click', () => {
                    this.hideAllSections();
                });
                
                document.getElementById('reorderSectionsBtn').addEventListener('click', () => {
                    this.reorderSections();
                });
                
                // إدارة المتجر
                document.getElementById('addStoreProductBtn').addEventListener('click', () => {
                    this.addStoreProduct();
                });
                
                document.getElementById('clearStoreFormBtn').addEventListener('click', () => {
                    this.clearStoreForm();
                });
                
                // إدارة الأيقونات
                document.getElementById('addIconBtn').addEventListener('click', () => {
                    this.addNewIcon();
                });
                
                // سلة المهملات
                document.getElementById('restoreAllTrashBtn').addEventListener('click', () => {
                    this.restoreAllTrash();
                });
                
                document.getElementById('emptyTrashBtn').addEventListener('click', () => {
                    this.emptyTrash();
                });
                
                // الثيمات والقوالب
                document.querySelectorAll('.apply-theme-btn').forEach(btn => {
                    btn.addEventListener('click', (e) => {
                        const theme = e.currentTarget.getAttribute('data-theme');
                        this.applyTheme(theme);
                    });
                });
                
                document.querySelectorAll('.apply-template-btn').forEach(btn => {
                    btn.addEventListener('click', (e) => {
                        const template = e.currentTarget.getAttribute('data-template');
                        this.applyTemplate(template);
                    });
                });
                
                document.querySelectorAll('.delete-template-btn').forEach(btn => {
                    btn.addEventListener('click', (e) => {
                        const template = e.currentTarget.getAttribute('data-template');
                        this.deleteTemplate(template);
                    });
                });
                
                // Upload template
                document.getElementById('uploadTemplateBtn').addEventListener('click', () => {
                    document.getElementById('templateUploadInput').click();
                });
                
                document.getElementById('templateUploadInput').addEventListener('change', (e) => {
                    this.uploadTemplate(e.target.files[0]);
                });
                
                // Editor tools
                document.querySelectorAll('.editor-tool').forEach(tool => {
                    tool.addEventListener('click', (e) => {
                        const action = e.currentTarget.getAttribute('data-action');
                        const theme = e.currentTarget.getAttribute('data-theme');
                        
                        if (action) {
                            this.handleEditorTool(action);
                        } else if (theme) {
                            this.applyTheme(theme);
                        }
                    });
                });
                
                // Drag and drop for media
                const mediaDropZone = document.getElementById('mediaDropZone');
                mediaDropZone.addEventListener('dragover', (e) => {
                    e.preventDefault();
                    mediaDropZone.style.borderColor = 'var(--success)';
                    mediaDropZone.style.background = '#f0f9ff';
                });
                
                mediaDropZone.addEventListener('dragleave', () => {
                    mediaDropZone.style.borderColor = 'var(--info)';
                    mediaDropZone.style.background = '#f8fafc';
                });
                
                mediaDropZone.addEventListener('drop', (e) => {
                    e.preventDefault();
                    mediaDropZone.style.borderColor = 'var(--info)';
                    mediaDropZone.style.background = '#f8fafc';
                    
                    if (e.dataTransfer.files.length) {
                        this.previewMediaFiles(e.dataTransfer.files);
                    }
                });
                
                // Keyboard shortcuts
                document.addEventListener('keydown', (e) => {
                    // F2 for control panel
                    if (e.key === 'F2') {
                        e.preventDefault();
                        this.promptForCode(CONFIG.MASTER_CODE, this.openControlPanel.bind(this), "لوحة التحكم");
                    }
                    
                    // F3 for edit mode
                    if (e.key === 'F3') {
                        e.preventDefault();
                        this.promptForCode(CONFIG.EDIT_CODE, this.activateOdoMode.bind(this), "وضع التعديل");
                    }
                    
                    // Ctrl+S to save in Odo mode
                    if (e.ctrlKey && e.key === 's' && STATE.isOdoMode) {
                        e.preventDefault();
                        this.saveAllEditsToFirebase();
                    }
                    
                    // Escape to close panels and exit edit mode
                    if (e.key === 'Escape') {
                        if (STATE.isControlPanelOpen) this.closeControlPanel();
                        if (STATE.isOdoMode) this.logoutAndLock();
                        document.getElementById('navSidebar').classList.remove('active');
                        
                        // إغلاق قائمة تعديل القسم
                        const dropdown = document.querySelector('.edit-section-dropdown');
                        if (dropdown) dropdown.classList.remove('active');
                        
                        // إخفاء الإعدادات إذا كانت ظاهرة
                        if (STATE.isSettingsHidden === false && STATE.isOdoMode) {
                            this.toggleSettingsVisibility();
                        }
                    }
                });
                
                // Close sidebar when clicking outside
                document.addEventListener('click', (e) => {
                    const sidebar = document.getElementById('navSidebar');
                    const menuToggle = document.getElementById('menuToggle');
                    
                    if (!sidebar.contains(e.target) && !menuToggle.contains(e.target) && sidebar.classList.contains('active')) {
                        sidebar.classList.remove('active');
                    }
                    
                    // إغلاق قائمة تعديل القسم عند النقر خارجها
                    const editSectionBtn = document.getElementById('sectionEditBtn');
                    const dropdown = document.querySelector('.edit-section-dropdown');
                    
                    if (dropdown && dropdown.classList.contains('active') && 
                        !editSectionBtn.contains(e.target) && !dropdown.contains(e.target)) {
                        dropdown.classList.remove('active');
                    }
                });
                
                // Close dropdown when scrolling
                window.addEventListener('scroll', () => {
                    const dropdown = document.querySelector('.edit-section-dropdown');
                    if (dropdown && dropdown.classList.contains('active')) {
                        dropdown.classList.remove('active');
                    }
                });
            },
            
            // إعداد قائمة تعديل القسم
            setupEditSectionDropdown() {
                const dropdown = document.createElement('div');
                dropdown.className = 'edit-section-dropdown';
                dropdown.id = 'editSectionDropdown';
                
                // الحصول على جميع الأقسام
                const sections = [
                    { id: 'home', name: 'الرئيسية', icon: 'fa-home' },
                    { id: 'products', name: 'صور المنتجات', icon: 'fa-images' },
                    { id: 'videos', name: 'فيديوهات المنتجات', icon: 'fa-video' },
                    { id: 'comments', name: 'التعليقات', icon: 'fa-comment-dots' },
                    { id: 'programmer', name: 'المبرمج', icon: 'fa-code' },
                    { id: 'store', name: 'المتجر', icon: 'fa-store' },
                    { id: 'location', name: 'الموقع والمكان', icon: 'fa-map-marker-alt' }
                ];
                
                sections.forEach(section => {
                    const item = document.createElement('div');
                    item.className = 'edit-section-item';
                    item.dataset.section = section.id;
                    item.innerHTML = `
                        <i class="fas ${section.icon}"></i>
                        <span>${section.name}</span>
                    `;
                    
                    item.addEventListener('click', () => {
                        this.editSelectedSection(section.id);
                        dropdown.classList.remove('active');
                    });
                    
                    dropdown.appendChild(item);
                });
                
                document.body.appendChild(dropdown);
            },
            
            // تبديل عرض قائمة تعديل القسم
            toggleEditSectionDropdown(e) {
                const dropdown = document.getElementById('editSectionDropdown');
                if (!dropdown) return;
                
                dropdown.classList.toggle('active');
                
                // وضع القائمة تحت الزر
                const btnRect = e.currentTarget.getBoundingClientRect();
                dropdown.style.top = `${btnRect.bottom + 5}px`;
                dropdown.style.left = `${btnRect.left}px`;
            },
            
            // تعديل القسم المحدد
            editSelectedSection(sectionId) {
                // طلب كود التعديل أولاً
                this.promptForCode(CONFIG.EDIT_CODE, () => {
                    // الانتقال إلى القسم المحدد
                    this.switchSection(sectionId);
                    
                    // تفعيل وضع التعديل بعد تأخير بسيط
                    setTimeout(() => {
                        this.activateOdoModeForSection(sectionId);
                    }, 500);
                    
                    this.showNotification(`تم تفعيل وضع التعديل للقسم: ${sectionId}`, 'success');
                }, "تعديل القسم");
            },
            
            // تفعيل وضع التعديل للقسم الحالي
            activateEditModeForCurrentSection() {
                const currentSection = STATE.currentSection;
                this.promptForCode(CONFIG.EDIT_CODE, () => {
                    this.activateOdoModeForSection(currentSection);
                    this.showNotification(`تم تفعيل وضع التعديل للقسم الحالي`, 'success');
                }, "تعديل القسم");
            },
            
            // تفعيل وضع التعديل لقسم معين
            activateOdoModeForSection(sectionId) {
                STATE.editModeActive = true;
                document.body.classList.add('edit-mode-active');
                
                // إظهار أزرار التعديل
                document.getElementById('odoControlButtons').style.display = 'flex';
                document.getElementById('floatingPlus').classList.add('active');
                document.getElementById('eyeToggleBtn').classList.add('active');
                document.getElementById('backToEditBtn').style.display = 'flex';
                document.getElementById('hideSettingsBtn').style.display = 'flex';
                document.getElementById('eyeAboveSaveBtn').style.display = 'flex';
                
                // جعل عناصر القسم الحالي قابلة للتعديل فقط
                const currentSection = document.getElementById(`${sectionId}-section`);
                if (currentSection) {
                    this.makeSectionEditable(currentSection);
                }
                
                // إضافة عناصر التحكم للقسم
                this.addVisibilityControl(currentSection);
                
                // تمكين السحب والإفلات
                this.enableDragAndDropForSection(currentSection);
            },
            
            // جعل قسم معين قابل للتعديل
            makeSectionEditable(section) {
                const editableSelectors = [
                    'h1', 'h2', 'h3', 'h4', 'h5', 'h6',
                    'p', 'span', 'li',
                    '.section-title', '.product-title', '.product-description',
                    '.product-price', '.programmer-title', '.programmer-description'
                ];
                
                editableSelectors.forEach(selector => {
                    section.querySelectorAll(selector).forEach(element => {
                        this.makeEditable(element, 'text');
                    });
                });
                
                // جعل الصور قابلة للتعديل
                section.querySelectorAll('img').forEach(img => {
                    this.makeEditable(img, 'image');
                });
                
                // جعل الروابط قابلة للتعديل
                section.querySelectorAll('a').forEach(link => {
                    this.makeEditable(link, 'link');
                });
            },
            
            // تمكين السحب والإفلات للقسم
            enableDragAndDropForSection(section) {
                let draggedElement = null;
                
                section.querySelectorAll('.editable-element, .template-container').forEach(element => {
                    element.draggable = true;
                    
                    element.addEventListener('dragstart', (e) => {
                        draggedElement = element;
                        e.dataTransfer.effectAllowed = 'move';
                        e.dataTransfer.setData('text/html', element.innerHTML);
                        element.style.opacity = '0.5';
                    });
                    
                    element.addEventListener('dragend', () => {
                        element.style.opacity = '1';
                        draggedElement = null;
                    });
                });
                
                section.addEventListener('dragover', (e) => {
                    e.preventDefault();
                    e.dataTransfer.dropEffect = 'move';
                });
                
                section.addEventListener('drop', (e) => {
                    e.preventDefault();
                    if (draggedElement && (e.target.classList.contains('editable-element') || e.target.classList.contains('template-container'))) {
                        const target = e.target.closest('.editable-element, .template-container');
                        if (target && target !== draggedElement) {
                            const temp = document.createElement('div');
                            temp.innerHTML = draggedElement.innerHTML;
                            draggedElement.innerHTML = target.innerHTML;
                            target.innerHTML = temp.innerHTML;
                            this.saveEdit(draggedElement);
                            this.saveEdit(target);
                        }
                    }
                });
            },
            
            // Switch between content sections
            switchSection(sectionId) {
                // Hide all sections
                document.querySelectorAll('.content-section').forEach(section => {
                    section.classList.remove('active');
                });
                
                // Show target section
                const targetSection = document.getElementById(`${sectionId}-section`);
                if (targetSection) {
                    targetSection.classList.add('active');
                    STATE.currentSection = sectionId;
                    
                    // Update URL hash
                    window.location.hash = sectionId;
                    
                    // Scroll to section
                    targetSection.scrollIntoView({ behavior: 'smooth', block: 'start' });
                    
                    // Trigger scroll reveal for new content
                    setTimeout(() => this.initScrollReveal(), 100);
                }
            },
            
            // Switch between panel tabs
            switchPanelTab(tabId) {
                // Remove active class from all tabs
                document.querySelectorAll('.panel-tab').forEach(tab => {
                    tab.classList.remove('active');
                });
                
                // Remove active class from all tab contents
                document.querySelectorAll('.tab-content').forEach(content => {
                    content.classList.remove('active');
                });
                
                // Add active class to clicked tab
                const tabElement = document.querySelector(`.panel-tab[data-tab="${tabId}"]`);
                if (tabElement) {
                    tabElement.classList.add('active');
                }
                
                // Show corresponding tab content
                const tabContent = document.getElementById(`${tabId}-tab`);
                if (tabContent) {
                    tabContent.classList.add('active');
                }
                
                // إذا كان قسم التخزين، قم بتحميل معلومات التخزين المحلي
                if (tabId === 'storage') {
                    this.updateLocalStorageInfo();
                }
            },
            
            // Open control panel
            openControlPanel() {
                document.getElementById('controlPanelOverlay').style.display = 'flex';
                document.body.style.overflow = 'hidden';
                STATE.isControlPanelOpen = true;
                
                // Load sections data
                this.loadSectionsData();
                
                // Load store products
                this.loadStoreProducts();
                
                // Load trash items
                this.loadTrashItems();
                
                // Load icons data
                this.loadIconsData();
                
                // Load storage connections
                this.loadStorageConnections();
                
                // Log access
                this.logControlPanelAccess();
            },
            
            // Close control panel
            closeControlPanel() {
                document.getElementById('controlPanelOverlay').style.display = 'none';
                document.body.style.overflow = 'auto';
                STATE.isControlPanelOpen = false;
                
                // Deactivate Odo mode if active
                if (STATE.isOdoMode || STATE.editModeActive) {
                    this.logoutAndLock();
                }
            },
            
            // Prompt for code with SweetAlert2
            promptForCode(expectedCode, successCallback, featureName) {
                Swal.fire({
                    title: `أدخل كود ${featureName}`,
                    input: 'password',
                    inputAttributes: {
                        autocapitalize: 'off',
                        autocorrect: 'off'
                    },
                    showCancelButton: true,
                    confirmButtonText: 'دخول',
                    cancelButtonText: 'إلغاء',
                    confirmButtonColor: '#1a365d',
                    cancelButtonColor: '#ef4444',
                    preConfirm: (code) => {
                        if (code === expectedCode) {
                            return code;
                        } else {
                            Swal.showValidationMessage('الكود غير صحيح');
                            return false;
                        }
                    }
                }).then((result) => {
                    if (result.isConfirmed) {
                        successCallback();
                    }
                });
            },
            
            // ========================================
            // وظيفة تسجيل الخروج المحسنة
            // ========================================
            logoutAndLock() {
                // 1. إيقاف وضع التعديل
                STATE.isOdoMode = false;
                STATE.editModeActive = false;
                CONFIG.IS_EDIT_MODE = false;
                
                // إزالة جميع كلاسات وضع التعديل
                document.body.classList.remove('odo-mode', 'edit-mode-active');
                
                // 2. إخفاء جميع أزرار التعديل والعناصر الإدارية
                document.getElementById('odoControlButtons').style.display = 'none';
                document.getElementById('floatingPlus').classList.remove('active');
                document.getElementById('eyeToggleBtn').classList.remove('active');
                document.getElementById('backToEditBtn').style.display = 'none';
                document.getElementById('hideSettingsBtn').style.display = 'none';
                document.getElementById('eyeAboveSaveBtn').style.display = 'none';
                document.getElementById('sectionEditBtn').style.display = 'none';
                document.getElementById('editSectionMainBtn').style.display = 'none';
                
                // إغلاق قائمة تعديل القسم إذا كانت مفتوحة
                const dropdown = document.querySelector('.edit-section-dropdown');
                if (dropdown) dropdown.classList.remove('active');
                
                // 3. إزالة جميع خصائص التعديل من العناصر
                document.querySelectorAll('.editable-element').forEach(element => {
                    element.classList.remove('editable-element');
                    element.removeAttribute('data-edit-tooltip');
                    element.draggable = false;
                    
                    // إزالة الأدوات
                    const toolbar = element.querySelector('.edit-toolbar');
                    if (toolbar) toolbar.remove();
                });
                
                // 4. إزالة علامات الرؤية
                document.querySelectorAll('.section-visibility').forEach(el => {
                    el.style.display = 'none';
                });
                
                // 5. إزالة خصائص contenteditable
                document.querySelectorAll('[contenteditable="true"]').forEach(el => {
                    el.contentEditable = 'false';
                    el.style.outline = 'none';
                });
                
                // 6. إزالة حدود التعديل
                document.querySelectorAll('.template-container').forEach(el => {
                    el.style.borderColor = '#e2e8f0';
                });
                
                // 7. إعادة تعيين جميع العناصر المخفية
                document.querySelectorAll('.hidden-section').forEach(el => {
                    el.classList.remove('hidden-section');
                });
                
                // 8. حفظ التعديلات النهائية
                this.saveAllEdits();
                
                // 9. إظهار الإشعار
                this.showNotification('تم تسجيل الخروج من وضع التعديل', 'success');
            },
            
            // تبديل إظهار/إخفاء قائمة الإعدادات
            toggleSettingsVisibility() {
                STATE.isSettingsHidden = !STATE.isSettingsHidden;
                
                const settingsElements = document.querySelectorAll('.odo-control-buttons, .floating-plus, .eye-toggle-btn, .section-visibility, .edit-toolbar, .template-controls');
                
                if (STATE.isSettingsHidden) {
                    settingsElements.forEach(el => {
                        el.style.display = 'none';
                    });
                    document.getElementById('hideSettingsBtn').innerHTML = '<i class="fas fa-eye"></i>';
                    document.getElementById('hideSettingsBtn').title = 'إظهار قائمة الإعدادات';
                    this.showNotification('تم إخفاء أدوات التعديل', 'info');
                } else {
                    if (STATE.isOdoMode || STATE.editModeActive) {
                        document.getElementById('odoControlButtons').style.display = 'flex';
                        document.getElementById('floatingPlus').classList.add('active');
                        document.getElementById('eyeToggleBtn').classList.add('active');
                        document.getElementById('eyeAboveSaveBtn').style.display = 'flex';
                    }
                    document.querySelectorAll('.section-visibility').forEach(el => {
                        el.style.display = 'block';
                    });
                    document.getElementById('hideSettingsBtn').innerHTML = '<i class="fas fa-eye-slash"></i>';
                    document.getElementById('hideSettingsBtn').title = 'إخفاء قائمة الإعدادات';
                    this.showNotification('تم إظهار أدوات التعديل', 'info');
                }
            },
            
            // Activate Odo editing mode
            activateOdoMode() {
                STATE.isOdoMode = true;
                CONFIG.IS_EDIT_MODE = true;
                document.body.classList.add('odo-mode');
                
                // Show floating control buttons
                document.getElementById('odoControlButtons').style.display = 'flex';
                document.getElementById('floatingPlus').classList.add('active');
                document.getElementById('eyeToggleBtn').classList.add('active');
                document.getElementById('backToEditBtn').style.display = 'flex';
                document.getElementById('hideSettingsBtn').style.display = 'flex';
                document.getElementById('eyeAboveSaveBtn').style.display = 'flex';
                document.getElementById('sectionEditBtn').style.display = 'flex';
                document.getElementById('editSectionMainBtn').style.display = 'flex';
                
                // Make all texts editable
                const editableSelectors = [
                    'h1', 'h2', 'h3', 'h4', 'h5', 'h6',
                    'p', 'span', 'li', 'td', 'th',
                    '.section-title', '.product-title', '.product-description',
                    '.product-price', '.programmer-title', '.programmer-description',
                    '.footer-title', '.social-title'
                ];
                
                editableSelectors.forEach(selector => {
                    document.querySelectorAll(selector).forEach(element => {
                        this.makeEditable(element, 'text');
                    });
                });
                
                // Make images editable
                document.querySelectorAll('img').forEach(img => {
                    this.makeEditable(img, 'image');
                });
                
                // Make social icons editable
                document.querySelectorAll('.social-icon').forEach(icon => {
                    this.makeEditable(icon, 'link');
                });
                
                // Make fixed CTA buttons editable
                document.querySelectorAll('.fixed-cta').forEach(cta => {
                    this.makeEditable(cta, 'link');
                });
                
                // Add visibility controls to sections
                document.querySelectorAll('.content-section').forEach(section => {
                    this.addVisibilityControl(section);
                });
                
                // Enable drag and drop
                this.enableDragAndDrop();
                
                // Add template containers for empty areas
                this.addTemplateContainers();
                
                // Show notification
                this.showNotification('تم تفعيل وضع التعديل', 'success');
            },
            
            // Add visibility control to section
            addVisibilityControl(section) {
                if (section.querySelector('.section-visibility')) return;
                
                const eyeBtn = document.createElement('div');
                eyeBtn.className = 'section-visibility';
                eyeBtn.innerHTML = '<i class="fas fa-eye-slash"></i>';
                eyeBtn.title = 'إظهار/إخفاء القسم';
                
                eyeBtn.addEventListener('click', (e) => {
                    e.stopPropagation();
                    section.classList.toggle('hidden-section');
                    eyeBtn.innerHTML = section.classList.contains('hidden-section') ? 
                        '<i class="fas fa-eye"></i>' : '<i class="fas fa-eye-slash"></i>';
                });
                
                section.style.position = 'relative';
                section.appendChild(eyeBtn);
            },
            
            // Toggle element visibility
            toggleElementVisibility() {
                const elements = document.querySelectorAll('.editable-element, .section-visibility, .template-container');
                let anyVisible = false;
                
                elements.forEach(el => {
                    if (el.style.display !== 'none') {
                        anyVisible = true;
                    }
                });
                
                elements.forEach(el => {
                    if (anyVisible) {
                        el.style.display = 'none';
                    } else {
                        el.style.display = '';
                    }
                });
                
                this.showNotification(anyVisible ? 'تم إخفاء أدوات التعديل' : 'تم إظهار أدوات التعديل', 'info');
            },
            
            // Show add template menu
            showAddTemplateMenu(x, y) {
                Swal.fire({
                    title: 'إضافة عنصر جديد',
                    html: `
                        <div style="text-align: center; padding: 20px;">
                            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-bottom: 20px;">
                                <button class="btn btn-primary template-type-btn" data-type="image">
                                    <i class="fas fa-image"></i>
                                    <span>صورة</span>
                                </button>
                                <button class="btn btn-primary template-type-btn" data-type="video">
                                    <i class="fas fa-video"></i>
                                    <span>فيديو</span>
                                </button>
                                <button class="btn btn-primary template-type-btn" data-type="gif">
                                    <i class="fas fa-film"></i>
                                    <span>GIF</span>
                                </button>
                                <button class="btn btn-primary template-type-btn" data-type="logo">
                                    <i class="fas fa-copyright"></i>
                                    <span>لوجو</span>
                                </button>
                                <button class="btn btn-secondary template-type-btn" data-type="text">
                                    <i class="fas fa-font"></i>
                                    <span>نص</span>
                                </button>
                                <button class="btn btn-secondary template-type-btn" data-type="product">
                                    <i class="fas fa-shopping-cart"></i>
                                    <span>منتج</span>
                                </button>
                            </div>
                            <div>
                                <input type="text" id="templateTitle" class="swal2-input" placeholder="عنوان العنصر">
                                <input type="text" id="templatePrice" class="swal2-input" placeholder="السعر (اختياري)">
                            </div>
                        </div>
                    `,
                    showConfirmButton: false,
                    showCancelButton: true,
                    cancelButtonText: 'إلغاء',
                    position: 'top',
                    backdrop: false,
                    width: 500,
                    customClass: {
                        popup: 'template-menu-popup'
                    },
                    didOpen: () => {
                        // Add event listeners to template buttons
                        document.querySelectorAll('.template-type-btn').forEach(btn => {
                            btn.addEventListener('click', (e) => {
                                const type = e.currentTarget.getAttribute('data-type');
                                const title = document.getElementById('templateTitle').value;
                                const price = document.getElementById('templatePrice').value;
                                
                                this.createNewTemplate(type, title, price);
                                Swal.close();
                            });
                        });
                    }
                });
            },
            
            // Create new template
            createNewTemplate(type, title = 'عنوان جديد', price = '') {
                const templateId = `template_${Date.now()}`;
                const template = document.createElement('div');
                template.className = 'template-container';
                template.id = templateId;
                template.draggable = true;
                
                let content = '';
                switch(type) {
                    case 'image':
                        content = `
                            <div style="text-align: center; padding: 30px; background: #f8fafc; border-radius: 10px; margin-bottom: 20px;">
                                <i class="fas fa-image" style="font-size: 3rem; color: var(--info); margin-bottom: 15px;"></i>
                                <h4>${title}</h4>
                                ${price ? `<div style="color: var(--secondary); font-size: 1.2rem; margin-top: 10px;">${price}</div>` : ''}
                                <p style="color: var(--gray); margin-top: 10px;">انقر لرفع صورة</p>
                            </div>
                        `;
                        break;
                    case 'video':
                        content = `
                            <div style="text-align: center; padding: 30px; background: #f8fafc; border-radius: 10px; margin-bottom: 20px;">
                                <i class="fas fa-video" style="font-size: 3rem; color: var(--danger); margin-bottom: 15px;"></i>
                                <h4>${title}</h4>
                                ${price ? `<div style="color: var(--secondary); font-size: 1.2rem; margin-top: 10px;">${price}</div>` : ''}
                                <p style="color: var(--gray); margin-top: 10px;">انقر لرفع فيديو</p>
                            </div>
                        `;
                        break;
                    case 'product':
                        content = `
                            <div style="background: white; border-radius: 10px; padding: 20px; box-shadow: var(--shadow);">
                                <div style="width: 100%; height: 150px; background: linear-gradient(135deg, var(--primary), var(--info)); border-radius: 8px; margin-bottom: 15px;"></div>
                                <h4>${title}</h4>
                                ${price ? `<div style="color: var(--secondary); font-size: 1.2rem; margin-top: 5px;">${price}</div>` : ''}
                                <p style="color: var(--gray); margin-top: 10px;">وصف المنتج</p>
                                <div style="display: flex; gap: 10px; margin-top: 15px;">
                                    <button class="btn btn-primary" style="padding: 8px 15px; font-size: 0.9rem;">اطلب الآن</button>
                                    <button class="btn btn-secondary" style="padding: 8px 15px; font-size: 0.9rem;">تفاصيل</button>
                                </div>
                            </div>
                        `;
                        break;
                    default:
                        content = `
                            <div style="text-align: center; padding: 30px; background: #f8fafc; border-radius: 10px;">
                                <h4>${title}</h4>
                                <p style="color: var(--gray); margin-top: 10px;">محتوى ${type}</p>
                            </div>
                        `;
                }
                
                template.innerHTML = content;
                
                // Add controls
                const controls = document.createElement('div');
                controls.className = 'template-controls';
                controls.innerHTML = `
                    <button class="template-btn edit-template" title="تعديل">
                        <i class="fas fa-edit"></i>
                    </button>
                    <button class="template-btn delete-template" title="حذف">
                        <i class="fas fa-trash"></i>
                    </button>
                    <button class="template-btn move-template" title="تحريك">
                        <i class="fas fa-arrows-alt"></i>
                    </button>
                `;
                template.appendChild(controls);
                
                // Add to current section
                const currentSection = document.querySelector('.content-section.active');
                if (currentSection) {
                    currentSection.appendChild(template);
                    
                    // Add event listeners to control buttons
                    controls.querySelector('.edit-template').addEventListener('click', () => {
                        this.editTemplate(template, type);
                    });
                    
                    controls.querySelector('.delete-template').addEventListener('click', () => {
                        if (confirm('هل تريد حذف هذا العنصر؟')) {
                            this.moveToTrash(template);
                            template.remove();
                        }
                    });
                    
                    // Make template editable
                    this.makeEditable(template, 'template');
                    
                    this.showNotification('تم إضافة العنصر بنجاح', 'success');
                }
            },
            
            // Edit template
            editTemplate(template, type) {
                Swal.fire({
                    title: 'تعديل العنصر',
                    html: `
                        <input type="text" id="editTemplateTitle" class="swal2-input" placeholder="العنوان الجديد" value="${template.querySelector('h4')?.textContent || ''}">
                        <input type="text" id="editTemplatePrice" class="swal2-input" placeholder="السعر الجديد" value="${template.querySelector('div[style*="color: var(--secondary)"]')?.textContent || ''}">
                        <textarea id="editTemplateDescription" class="swal2-textarea" placeholder="الوصف الجديد">${template.querySelector('p')?.textContent || ''}</textarea>
                    `,
                    showCancelButton: true,
                    confirmButtonText: 'حفظ',
                    cancelButtonText: 'إلغاء'
                }).then((result) => {
                    if (result.isConfirmed) {
                        const title = document.getElementById('editTemplateTitle').value;
                        const price = document.getElementById('editTemplatePrice').value;
                        const description = document.getElementById('editTemplateDescription').value;
                        
                        // Update template content
                        const titleElement = template.querySelector('h4');
                        if (titleElement) titleElement.textContent = title;
                        
                        const priceElement = template.querySelector('div[style*="color: var(--secondary)"]');
                        if (priceElement && price) {
                            priceElement.textContent = price;
                        } else if (price) {
                            const newPriceElement = document.createElement('div');
                            newPriceElement.style.cssText = 'color: var(--secondary); font-size: 1.2rem; margin-top: 10px;';
                            newPriceElement.textContent = price;
                            template.querySelector('div').appendChild(newPriceElement);
                        }
                        
                        const descriptionElement = template.querySelector('p');
                        if (descriptionElement) descriptionElement.textContent = description;
                        
                        this.saveEdit(template);
                        this.showNotification('تم تحديث العنصر', 'success');
                    }
                });
            },
            
            // Add template containers to empty areas
            addTemplateContainers() {
                // Find empty areas in sections
                document.querySelectorAll('.content-section').forEach(section => {
                    const children = section.children;
                    if (children.length < 3) { // If section has few elements
                        for (let i = children.length; i < 5; i++) {
                            const container = document.createElement('div');
                            container.className = 'template-container template-empty';
                            container.innerHTML = `
                                <div style="text-align: center; padding: 40px; color: var(--gray);">
                                    <i class="fas fa-plus" style="font-size: 2rem; margin-bottom: 15px;"></i>
                                    <p>انقر لإضافة محتوى</p>
                                </div>
                            `;
                            container.addEventListener('click', () => {
                                this.showAddTemplateMenu();
                            });
                            section.appendChild(container);
                        }
                    }
                });
            },
            
            // Make element editable
            makeEditable(element, type) {
                element.classList.add('editable-element');
                
                // Set tooltip based on type
                const tooltips = {
                    'text': 'انقر لتعديل النص',
                    'image': 'انقر لتغيير الصورة',
                    'link': 'انقر لتغيير الرابط',
                    'template': 'انقر لتعديل القالب'
                };
                element.setAttribute('data-edit-tooltip', tooltips[type] || 'انقر للتعديل');
                
                // Create and attach toolbar
                const toolbar = this.createEditToolbar(element, type);
                element.appendChild(toolbar);
                
                // Add click event based on type
                element.addEventListener('click', (e) => {
                    if (e.target.closest('.toolbar-btn') || e.target.closest('.template-controls')) return;
                    
                    switch(type) {
                        case 'text':
                            this.editText(element);
                            break;
                        case 'image':
                            this.editImage(element);
                            break;
                        case 'link':
                            this.editLink(element);
                            break;
                        case 'template':
                            this.editTemplate(element, 'template');
                            break;
                    }
                });
            },
            
            // Create edit toolbar for element
            createEditToolbar(element, type) {
                const toolbar = document.createElement('div');
                toolbar.className = 'edit-toolbar';
                
                const buttons = [
                    { icon: 'fas fa-trash', action: 'delete', title: 'حذف' },
                    { icon: 'fas fa-copy', action: 'duplicate', title: 'نسخ' },
                    { icon: 'fas fa-arrows-alt', action: 'move', title: 'تحريك' }
                ];
                
                if (type === 'text') {
                    buttons.unshift(
                        { icon: 'fas fa-bold', action: 'bold', title: 'عريض' },
                        { icon: 'fas fa-italic', action: 'italic', title: 'مائل' },
                        { icon: 'fas fa-palette', action: 'color', title: 'لون' }
                    );
                }
                
                if (type === 'image') {
                    buttons.unshift(
                        { icon: 'fas fa-upload', action: 'upload', title: 'رفع صورة' }
                    );
                }
                
                buttons.forEach(btn => {
                    const button = document.createElement('button');
                    button.className = 'toolbar-btn';
                    button.innerHTML = `<i class="${btn.icon}"></i>`;
                    button.title = btn.title;
                    button.addEventListener('click', (e) => {
                        e.stopPropagation();
                        this.handleToolbarAction(btn.action, element, type);
                    });
                    toolbar.appendChild(button);
                });
                
                return toolbar;
            },
            
            // Handle toolbar actions
            handleToolbarAction(action, element, type) {
                switch(action) {
                    case 'delete':
                        if (confirm('هل أنت متأكد من حذف هذا العنصر؟')) {
                            this.moveToTrash(element);
                            element.remove();
                        }
                        break;
                        
                    case 'duplicate':
                        const clone = element.cloneNode(true);
                        element.after(clone);
                        this.makeEditable(clone, type);
                        break;
                        
                    case 'bold':
                        document.execCommand('bold');
                        break;
                        
                    case 'italic':
                        document.execCommand('italic');
                        break;
                        
                    case 'color':
                        const color = prompt('أدخل اللون (اسم أو كود hex):', '#000000');
                        if (color) element.style.color = color;
                        break;
                        
                    case 'upload':
                        this.editImage(element);
                        break;
                        
                    case 'move':
                        // Dragging is already enabled
                        break;
                }
            },
            
            // Handle editor tools
            handleEditorTool(action) {
                switch(action) {
                    case 'edit-text':
                        this.showNotification('انقر على أي نص لتعديله', 'info');
                        break;
                    case 'edit-images':
                        this.showNotification('انقر على أي صورة لتغييرها', 'info');
                        break;
                    case 'edit-links':
                        this.showNotification('انقر على أي رابط لتعديله', 'info');
                        break;
                    case 'edit-colors':
                        this.showColorPicker();
                        break;
                    case 'add-elements':
                        this.showAddTemplateMenu();
                        break;
                    case 'rearrange':
                        this.showNotification('اسحب وأفلت العناصر لإعادة ترتيبها', 'info');
                        break;
                }
            },
            
            // Show color picker
            showColorPicker() {
                Swal.fire({
                    title: 'تعديل الألوان',
                    html: `
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-top: 15px;">
                            <div>
                                <label style="display: block; margin-bottom: 8px;">اللون الرئيسي</label>
                                <input type="color" id="quickPrimaryColor" value="#1a365d" style="width: 100%; height: 50px; border-radius: 8px;">
                            </div>
                            <div>
                                <label style="display: block; margin-bottom: 8px;">لون التمييز</label>
                                <input type="color" id="quickAccentColor" value="#d4af37" style="width: 100%; height: 50px; border-radius: 8px;">
                            </div>
                        </div>
                    `,
                    showCancelButton: true,
                    confirmButtonText: 'تطبيق',
                    cancelButtonText: 'إلغاء'
                }).then((result) => {
                    if (result.isConfirmed) {
                        const primaryColor = document.getElementById('quickPrimaryColor').value;
                        const accentColor = document.getElementById('quickAccentColor').value;
                        
                        const root = document.documentElement;
                        root.style.setProperty('--primary', primaryColor);
                        root.style.setProperty('--accent', accentColor);
                        
                        this.showNotification('تم تطبيق الألوان الجديدة', 'success');
                    }
                });
            },
            
            // Edit text element
            editText(element) {
                const currentText = element.textContent;
                const newText = prompt('عدل النص:', currentText);
                if (newText !== null && newText !== currentText) {
                    element.textContent = newText;
                    this.saveEdit(element);
                }
            },
            
            // Edit image element
            editImage(imgElement) {
                Swal.fire({
                    title: 'تغيير الصورة',
                    html: `
                        <div style="text-align: center;">
                            <p>اختر طريقة رفع الصورة:</p>
                            <div style="display: flex; flex-direction: column; gap: 15px; margin-top: 20px;">
                                <input type="url" id="imageUrlInput" class="swal2-input" placeholder="رابط الصورة من الإنترنت">
                                <div>
                                    <label style="display: block; margin-bottom: 8px; text-align: right;">أو رفع من جهازك:</label>
                                    <input type="file" id="imageFileInput" class="swal2-input" accept="image/*">
                                </div>
                            </div>
                        </div>
                    `,
                    showCancelButton: true,
                    confirmButtonText: 'تغيير',
                    cancelButtonText: 'إلغاء',
                    preConfirm: () => {
                        const url = document.getElementById('imageUrlInput').value.trim();
                        const file = document.getElementById('imageFileInput').files[0];
                        
                        if (url) {
                            return { type: 'url', value: url };
                        } else if (file) {
                            return { type: 'file', value: file };
                        } else {
                            Swal.showValidationMessage('أدخل رابط أو اختر ملف');
                            return false;
                        }
                    }
                }).then(result => {
                    if (result.isConfirmed) {
                        if (result.value.type === 'url') {
                            imgElement.src = result.value.value;
                        } else {
                            const reader = new FileReader();
                            reader.onload = function(e) {
                                imgElement.src = e.target.result;
                            };
                            reader.readAsDataURL(result.value.value);
                        }
                        this.saveEdit(imgElement);
                        this.showNotification('تم تغيير الصورة', 'success');
                    }
                });
            },
            
            // Edit link element
            editLink(linkElement) {
                const currentLink = linkElement.href || linkElement.getAttribute('data-link') || '#';
                const newLink = prompt('عدل الرابط:', currentLink);
                if (newLink !== null && newLink !== currentLink) {
                    if (linkElement.tagName === 'A') {
                        linkElement.href = newLink;
                    } else {
                        linkElement.setAttribute('data-link', newLink);
                        linkElement.onclick = () => window.open(newLink, '_blank');
                    }
                    this.saveEdit(linkElement);
                }
            },
            
            // Enable drag and drop for editable elements
            enableDragAndDrop() {
                let draggedElement = null;
                
                document.querySelectorAll('.editable-element, .template-container').forEach(element => {
                    element.draggable = true;
                    
                    element.addEventListener('dragstart', (e) => {
                        draggedElement = element;
                        e.dataTransfer.effectAllowed = 'move';
                        e.dataTransfer.setData('text/html', element.innerHTML);
                        element.style.opacity = '0.5';
                    });
                    
                    element.addEventListener('dragend', () => {
                        element.style.opacity = '1';
                        draggedElement = null;
                    });
                });
                
                document.addEventListener('dragover', (e) => {
                    e.preventDefault();
                    e.dataTransfer.dropEffect = 'move';
                });
                
                document.addEventListener('drop', (e) => {
                    e.preventDefault();
                    if (draggedElement && (e.target.classList.contains('editable-element') || e.target.classList.contains('template-container'))) {
                        const target = e.target.closest('.editable-element, .template-container');
                        if (target && target !== draggedElement) {
                            const temp = document.createElement('div');
                            temp.innerHTML = draggedElement.innerHTML;
                            draggedElement.innerHTML = target.innerHTML;
                            target.innerHTML = temp.innerHTML;
                            this.saveEdit(draggedElement);
                            this.saveEdit(target);
                        }
                    }
                });
            },
            
            // Save edit to localStorage and Firebase
            saveEdit(element) {
                const elementId = element.id || `edit_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`;
                if (!element.id) element.id = elementId;
                
                const editData = {
                    id: elementId,
                    html: element.outerHTML,
                    tagName: element.tagName,
                    className: element.className,
                    timestamp: Date.now()
                };
                
                // Save to STATE
                STATE.edits[elementId] = editData;
                
                // Save to localStorage
                localStorage.setItem(`edit_${elementId}`, JSON.stringify(editData));
                
                // Save to Firebase if connected
                if (firestore && STATE.activeStorage === 'firebase') {
                    firestore.collection('site_edits').doc(elementId).set(editData)
                        .catch(error => console.error('Error saving to Firebase:', error));
                }
                
                this.showNotification('تم حفظ التعديل', 'success');
            },
            
            // Save all edits to Firebase immediately
            saveAllEditsToFirebase() {
                if (!firestore) {
                    this.showNotification('Firebase غير متصل', 'error');
                    return;
                }
                
                // Sync with Firebase
                firestore.collection('site_edits').get().then(snapshot => {
                    const batch = firestore.batch();
                    
                    // Delete all existing edits
                    snapshot.docs.forEach(doc => {
                        batch.delete(doc.ref);
                    });
                    
                    // Add all current edits
                    Object.values(STATE.edits).forEach(edit => {
                        const docRef = firestore.collection('site_edits').doc(edit.id);
                        batch.set(docRef, edit);
                    });
                    
                    return batch.commit();
                }).then(() => {
                    this.showNotification('تم حفظ جميع التعديلات في Firebase', 'success');
                }).catch(error => {
                    console.error('Error saving to Firebase:', error);
                    this.showNotification('تم حفظ التعديلات محلياً', 'info');
                });
            },
            
            // Save all edits
            saveAllEdits() {
                Object.values(STATE.edits).forEach(edit => {
                    const element = document.getElementById(edit.id);
                    if (element) {
                        // Update element from edit data if needed
                    }
                });
                
                // Sync with Firebase
                if (firestore && STATE.activeStorage === 'firebase') {
                    this.saveAllEditsToFirebase();
                } else {
                    this.showNotification('تم حفظ جميع التعديلات محلياً', 'success');
                }
            },
            
            // Reset all edits
            resetAllEdits() {
                Swal.fire({
                    title: 'هل أنت متأكد؟',
                    text: 'سيتم استعادة النسخة الأصلية للموقع وفقدان جميع التعديلات',
                    icon: 'warning',
                    showCancelButton: true,
                    confirmButtonColor: '#ef4444',
                    cancelButtonColor: '#6b7280',
                    confirmButtonText: 'نعم، استعادة',
                    cancelButtonText: 'إلغاء'
                }).then((result) => {
                    if (result.isConfirmed) {
                        // Clear localStorage
                        Object.keys(localStorage).forEach(key => {
                            if (key.startsWith('edit_')) {
                                localStorage.removeItem(key);
                            }
                        });
                        
                        // Clear STATE
                        STATE.edits = {};
                        
                        // Clear Firebase
                        if (firestore) {
                            firestore.collection('site_edits').get().then(snapshot => {
                                const batch = firestore.batch();
                                snapshot.docs.forEach(doc => {
                                    batch.delete(doc.ref);
                                });
                                batch.commit();
                            });
                        }
                        
                        // Reload page
                        location.reload();
                    }
                });
            },
            
            // Move element to trash
            moveToTrash(element) {
                const trashItem = {
                    id: element.id || `trash_${Date.now()}`,
                    html: element.outerHTML,
                    type: element.tagName || 'template',
                    name: element.querySelector('h4')?.textContent || element.textContent.substring(0, 50) || 'عنصر بدون اسم',
                    timestamp: Date.now()
                };
                
                STATE.trash.push(trashItem);
                localStorage.setItem('site_trash', JSON.stringify(STATE.trash));
                
                // Save to Firebase
                if (firestore) {
                    firestore.collection('trash').doc(trashItem.id).set(trashItem);
                }
                
                this.showNotification('تم نقل العنصر إلى سلة المهملات', 'info');
            },
            
            // Load trash items
            loadTrashItems() {
                if (!firestore) return;
                
                firestore.collection('trash').get().then(snapshot => {
                    const trashList = document.getElementById('trashItemsList');
                    trashList.innerHTML = '';
                    
                    snapshot.forEach(doc => {
                        const item = doc.data();
                        const itemElement = document.createElement('div');
                        itemElement.className = 'section-item';
                        itemElement.innerHTML = `
                            <div>
                                <strong>${item.name}</strong>
                                <div style="color: var(--gray); font-size: 0.9rem;">
                                    ${new Date(item.timestamp).toLocaleDateString('ar-SA')}
                                </div>
                            </div>
                            <div style="display: flex; gap: 10px;">
                                <button class="btn btn-success restore-trash-btn" data-id="${item.id}">
                                    <i class="fas fa-trash-restore"></i>
                                    <span>استعادة</span>
                                </button>
                                <button class="btn btn-danger delete-trash-btn" data-id="${item.id}">
                                    <i class="fas fa-trash"></i>
                                </button>
                            </div>
                        `;
                        
                        trashList.appendChild(itemElement);
                        
                        // Add event listeners
                        itemElement.querySelector('.restore-trash-btn').addEventListener('click', () => {
                            this.restoreFromTrash(item.id);
                        });
                        
                        itemElement.querySelector('.delete-trash-btn').addEventListener('click', () => {
                            this.deleteFromTrash(item.id);
                        });
                    });
                });
            },
            
            // Restore from trash
            restoreFromTrash(itemId) {
                if (!firestore) return;
                
                firestore.collection('trash').doc(itemId).get().then(doc => {
                    if (doc.exists) {
                        const item = doc.data();
                        
                        // Remove from trash
                        firestore.collection('trash').doc(itemId).delete();
                        
                        // Try to restore element
                        const element = document.getElementById(itemId);
                        if (element && item.html) {
                            element.outerHTML = item.html;
                        }
                        
                        this.showNotification('تم استعادة العنصر', 'success');
                        this.loadTrashItems(); // Refresh list
                    }
                });
            },
            
            // Delete from trash permanently
            deleteFromTrash(itemId) {
                if (!firestore) return;
                
                firestore.collection('trash').doc(itemId).delete()
                    .then(() => {
                        this.showNotification('تم حذف العنصر نهائياً', 'success');
                        this.loadTrashItems(); // Refresh list
                    });
            },
            
            // Restore all trash
            restoreAllTrash() {
                if (!firestore) return;
                
                Swal.fire({
                    title: 'هل أنت متأكد؟',
                    text: 'سيتم استعادة جميع العناصر من سلة المهملات',
                    icon: 'warning',
                    showCancelButton: true,
                    confirmButtonColor: '#10b981',
                    cancelButtonColor: '#6b7280',
                    confirmButtonText: 'نعم، استعادة الكل',
                    cancelButtonText: 'إلغاء'
                }).then((result) => {
                    if (result.isConfirmed) {
                        firestore.collection('trash').get().then(snapshot => {
                            snapshot.forEach(doc => {
                                const item = doc.data();
                                // Remove from trash
                                doc.ref.delete();
                                
                                // Try to restore element
                                const element = document.getElementById(item.id);
                                if (element && item.html) {
                                    element.outerHTML = item.html;
                                }
                            });
                            
                            this.showNotification('تم استعادة جميع العناصر', 'success');
                            this.loadTrashItems();
                        });
                    }
                });
            },
            
            // Empty trash
            emptyTrash() {
                if (!firestore) return;
                
                Swal.fire({
                    title: 'هل أنت متأكد؟',
                    text: 'سيتم حذف جميع العناصر من سلة المهملات نهائياً',
                    icon: 'warning',
                    showCancelButton: true,
                    confirmButtonColor: '#ef4444',
                    cancelButtonColor: '#6b7280',
                    confirmButtonText: 'نعم، حذف الكل',
                    cancelButtonText: 'إلغاء'
                }).then((result) => {
                    if (result.isConfirmed) {
                        firestore.collection('trash').get().then(snapshot => {
                            snapshot.forEach(doc => {
                                doc.ref.delete();
                            });
                            
                            this.showNotification('تم تفريغ سلة المهملات', 'success');
                            this.loadTrashItems();
                        });
                    }
                });
            },
            
            // ========================================
            // إدارة التخزين المتقدم
            // ========================================
            showStorageConnectionForm(storageType) {
                // إخفاء جميع النماذج أولاً
                document.querySelectorAll('.storage-connection-form').forEach(form => {
                    form.classList.remove('active');
                });
                
                // إظهار النموذج المطلوب
                const form = document.getElementById(`${storageType}-form`);
                if (form) {
                    form.classList.add('active');
                }
                
                // إذا كان تخزين محلي، عرض المعلومات
                if (storageType === 'local') {
                    this.updateLocalStorageInfo();
                }
            },
            
            updateLocalStorageInfo() {
                if (typeof localStorage !== 'undefined') {
                    let total = 0;
                    for (let i = 0; i < localStorage.length; i++) {
                        const key = localStorage.key(i);
                        if (key) {
                            const value = localStorage.getItem(key);
                            total += key.length + value.length;
                        }
                    }
                    
                    const usedKB = (total / 1024).toFixed(2);
                    const maxKB = 5120; // 5MB typical limit
                    const percent = (total / (maxKB * 1024) * 100).toFixed(1);
                    
                    const infoElement = document.getElementById('local-storage-info');
                    if (infoElement) {
                        infoElement.innerHTML = `
                            <div>المستخدم: ${usedKB} KB</div>
                            <div>النسبة: ${percent}%</div>
                            <div style="width: 100%; height: 10px; background: #e2e8f0; border-radius: 5px; margin-top: 5px;">
                                <div style="width: ${percent}%; height: 100%; background: ${percent > 80 ? 'var(--danger)' : 'var(--success)'}; border-radius: 5px;"></div>
                            </div>
                        `;
                    }
                }
            },
            
            saveFirebaseConnection() {
                const apiKey = document.getElementById('firebase-api-key').value.trim();
                const authDomain = document.getElementById('firebase-auth-domain').value.trim();
                const projectId = document.getElementById('firebase-project-id').value.trim();
                
                if (!apiKey || !authDomain || !projectId) {
                    this.showNotification('الرجاء ملء جميع الحقول', 'error');
                    return;
                }
                
                STATE.storageConnections.firebase = {
                    connected: true,
                    config: {
                        apiKey: apiKey,
                        authDomain: authDomain,
                        projectId: projectId
                    }
                };
                
                // حفظ في localStorage
                localStorage.setItem('firebase_connection', JSON.stringify(STATE.storageConnections.firebase));
                
                this.showNotification('تم حفظ إعدادات Firebase بنجاح', 'success');
            },
            
            saveGmailConnection() {
                const email = document.getElementById('gmail-email').value.trim();
                const password = document.getElementById('gmail-password').value.trim();
                
                if (!email || !password) {
                    this.showNotification('الرجاء ملء جميع الحقول', 'error');
                    return;
                }
                
                STATE.storageConnections.gmail = {
                    connected: true,
                    email: email,
                    password: password
                };
                
                // حفظ في localStorage
                localStorage.setItem('gmail_connection', JSON.stringify(STATE.storageConnections.gmail));
                
                this.showNotification('تم حفظ إعدادات Gmail بنجاح', 'success');
            },
            
            saveTelegramConnection() {
                const botToken = document.getElementById('telegram-bot-token').value.trim();
                const channelId = document.getElementById('telegram-channel-id').value.trim();
                
                if (!botToken || !channelId) {
                    this.showNotification('الرجاء ملء جميع الحقول', 'error');
                    return;
                }
                
                STATE.storageConnections.telegram = {
                    connected: true,
                    botToken: botToken,
                    channelId: channelId
                };
                
                // حفظ في localStorage
                localStorage.setItem('telegram_connection', JSON.stringify(STATE.storageConnections.telegram));
                
                this.showNotification('تم حفظ إعدادات Telegram بنجاح', 'success');
            },
            
            saveTeraboxConnection() {
                const email = document.getElementById('terabox-email').value.trim();
                const password = document.getElementById('terabox-password').value.trim();
                
                if (!email || !password) {
                    this.showNotification('الرجاء ملء جميع الحقول', 'error');
                    return;
                }
                
                STATE.storageConnections.terabox = {
                    connected: true,
                    email: email,
                    password: password
                };
                
                // حفظ في localStorage
                localStorage.setItem('terabox_connection', JSON.stringify(STATE.storageConnections.terabox));
                
                this.showNotification('تم حفظ إعدادات Terabox بنجاح', 'success');
            },
            
            clearLocalStorage() {
                Swal.fire({
                    title: 'هل أنت متأكد؟',
                    text: 'سيتم مسح جميع البيانات المحفوظة محلياً',
                    icon: 'warning',
                    showCancelButton: true,
                    confirmButtonColor: '#ef4444',
                    cancelButtonColor: '#6b7280',
                    confirmButtonText: 'نعم، مسح الكل',
                    cancelButtonText: 'إلغاء'
                }).then((result) => {
                    if (result.isConfirmed) {
                        localStorage.clear();
                        this.showNotification('تم مسح التخزين المحلي بنجاح', 'success');
                        this.updateLocalStorageInfo();
                    }
                });
            },
            
            loadStorageConnections() {
                // تحميل اتصالات Firebase
                const firebaseConn = localStorage.getItem('firebase_connection');
                if (firebaseConn) {
                    try {
                        STATE.storageConnections.firebase = JSON.parse(firebaseConn);
                    } catch (e) {
                        console.error('Error loading Firebase connection:', e);
                    }
                }
                
                // تحميل اتصالات Gmail
                const gmailConn = localStorage.getItem('gmail_connection');
                if (gmailConn) {
                    try {
                        STATE.storageConnections.gmail = JSON.parse(gmailConn);
                    } catch (e) {
                        console.error('Error loading Gmail connection:', e);
                    }
                }
                
                // تحميل اتصالات Telegram
                const telegramConn = localStorage.getItem('telegram_connection');
                if (telegramConn) {
                    try {
                        STATE.storageConnections.telegram = JSON.parse(telegramConn);
                    } catch (e) {
                        console.error('Error loading Telegram connection:', e);
                    }
                }
                
                // تحميل اتصالات Terabox
                const teraboxConn = localStorage.getItem('terabox_connection');
                if (teraboxConn) {
                    try {
                        STATE.storageConnections.terabox = JSON.parse(teraboxConn);
                    } catch (e) {
                        console.error('Error loading Terabox connection:', e);
                    }
                }
            },
            
            // ========================================
            // بقية الدوال...
            // ========================================
            
            // إدارة الأقسام
            addNewSection() {
                const name = document.getElementById('newSectionName').value.trim();
                const icon = document.getElementById('newSectionIcon').value;
                
                if (!name) {
                    this.showNotification('الرجاء إدخال اسم القسم', 'error');
                    return;
                }
                
                const sectionId = name.replace(/\s+/g, '-').toLowerCase();
                
                // Add to navigation
                const navItem = document.createElement('div');
                navItem.className = 'nav-section-item';
                navItem.setAttribute('data-section', sectionId);
                navItem.innerHTML = `
                    <i class="fas ${icon}"></i>
                    <span>${name}</span>
                `;
                
                navItem.addEventListener('click', () => {
                    this.switchSection(sectionId);
                    document.getElementById('navSidebar').classList.remove('active');
                });
                
                document.getElementById('navSections').appendChild(navItem);
                
                // Create section content
                const section = document.createElement('section');
                section.id = `${sectionId}-section`;
                section.className = 'content-section';
                section.innerHTML = `
                    <div class="section-header">
                        <h2 class="section-title">${name}</h2>
                        <p style="font-size: 1.2rem; color: var(--gray); max-width: 800px; margin: 20px auto;">
                            محتوى قسم ${name}
                        </p>
                    </div>
                    <div class="template-container" style="min-height: 300px;">
                        <div style="text-align: center; padding: 50px; color: var(--gray);">
                            <i class="fas ${icon}" style="font-size: 3rem; margin-bottom: 20px;"></i>
                            <h3>${name}</h3>
                            <p>انقر لإضافة محتوى إلى هذا القسم</p>
                        </div>
                    </div>
                `;
                
                document.querySelector('.main-content').appendChild(section);
                
                // Make editable in Odo mode
                if (STATE.isOdoMode || STATE.editModeActive) {
                    this.makeEditable(section.querySelector('h2'), 'text');
                    this.makeEditable(section.querySelector('p'), 'text');
                    this.addVisibilityControl(section);
                }
                
                // Save to Firebase
                if (firestore) {
                    firestore.collection('sections').doc(sectionId).set({
                        name: name,
                        icon: icon,
                        visible: true,
                        order: STATE.sections.length,
                        timestamp: Date.now()
                    });
                }
                
                // Clear form
                document.getElementById('newSectionName').value = '';
                
                this.showNotification(`تم إضافة قسم "${name}" بنجاح`, 'success');
            },
            
            // Load sections data
            loadSectionsData() {
                if (!firestore) return;
                
                firestore.collection('sections').orderBy('order').get().then(snapshot => {
                    const sectionsList = document.getElementById('sectionsList');
                    sectionsList.innerHTML = '';
                    
                    snapshot.forEach(doc => {
                        const section = doc.data();
                        section.id = doc.id;
                        
                        const item = document.createElement('div');
                        item.className = 'section-item';
                        item.innerHTML = `
                            <div style="display: flex; align-items: center; gap: 15px;">
                                <i class="fas ${section.icon}" style="color: var(--primary);"></i>
                                <div>
                                    <strong>${section.name}</strong>
                                    <div style="color: var(--gray); font-size: 0.9rem;">
                                        ID: ${section.id}
                                    </div>
                                </div>
                            </div>
                            <div style="display: flex; gap: 10px;">
                                <button class="btn btn-secondary edit-section-btn" data-id="${section.id}">
                                    <i class="fas fa-edit"></i>
                                </button>
                                <button class="btn btn-danger delete-section-btn" data-id="${section.id}">
                                    <i class="fas fa-trash"></i>
                                </button>
                                <label style="display: flex; align-items: center; gap: 5px;">
                                    <input type="checkbox" class="section-visible-checkbox" data-id="${section.id}" ${section.visible ? 'checked' : ''}>
                                    <span>ظاهر</span>
                                </label>
                            </div>
                        `;
                        
                        sectionsList.appendChild(item);
                        
                        // Add event listeners
                        item.querySelector('.edit-section-btn').addEventListener('click', () => {
                            this.editSection(section);
                        });
                        
                        item.querySelector('.delete-section-btn').addEventListener('click', () => {
                            this.deleteSection(section.id, section.name);
                        });
                        
                        item.querySelector('.section-visible-checkbox').addEventListener('change', (e) => {
                            this.toggleSectionVisibility(section.id, e.target.checked);
                        });
                    });
                });
            },
            
            // بقية دوال إدارة الأقسام...
            
            // إدارة المتجر
            addStoreProduct() {
                const title = document.getElementById('storeProductTitle').value.trim();
                const price = document.getElementById('storeProductPrice').value.trim();
                const description = document.getElementById('storeProductDescription').value.trim();
                const whatsapp = document.getElementById('storeWhatsappLink').value.trim();
                const instagram = document.getElementById('storeInstagramLink').value.trim();
                const imageFile = document.getElementById('storeProductImage').files[0];
                
                if (!title) {
                    this.showNotification('الرجاء إدخال اسم المنتج', 'error');
                    return;
                }
                
                const productId = `product_${Date.now()}`;
                
                // Upload image if exists
                if (imageFile) {
                    const reader = new FileReader();
                    reader.onload = (e) => {
                        this.saveStoreProduct(productId, title, price, description, whatsapp, instagram, e.target.result);
                    };
                    reader.readAsDataURL(imageFile);
                } else {
                    this.saveStoreProduct(productId, title, price, description, whatsapp, instagram, null);
                }
            },
            
            // بقية دوال إدارة المتجر...
            
            // إدارة الأيقونات
            loadIconsData() {
                const iconsList = document.getElementById('iconsList');
                if (!iconsList) return;
                
                iconsList.innerHTML = '';
                
                CONFIG.DEFAULT_DATA.socialLinks.forEach(icon => {
                    const iconElement = document.createElement('div');
                    iconElement.className = 'storage-provider';
                    iconElement.innerHTML = `
                        <i class="${icon.icon}" style="font-size: 1.5rem; color: ${this.getIconColor(icon.type)};"></i>
                        <div style="flex: 1;">
                            <strong>${this.getIconName(icon.type)}</strong>
                            <p style="color: var(--gray); font-size: 0.9rem; word-break: break-all;">${icon.url}</p>
                        </div>
                        <div style="display: flex; gap: 10px;">
                            <button class="btn btn-secondary edit-icon-btn" data-type="${icon.type}">
                                <i class="fas fa-edit"></i>
                            </button>
                            <button class="btn btn-danger delete-icon-btn" data-type="${icon.type}">
                                <i class="fas fa-trash"></i>
                            </button>
                        </div>
                    `;
                    
                    iconsList.appendChild(iconElement);
                    
                    // Add event listeners
                    iconElement.querySelector('.edit-icon-btn').addEventListener('click', () => {
                        this.editIcon(icon.type, icon.url);
                    });
                    
                    iconElement.querySelector('.delete-icon-btn').addEventListener('click', () => {
                        this.deleteIcon(icon.type);
                    });
                });
            },
            
            // بقية دوال إدارة الأيقونات...
            
            // الثيمات والقوالب
            applyTheme(themeName) {
                // Remove existing theme classes
                document.body.classList.remove('light-theme', 'dark-theme', 'blue-theme', 'night-theme', 'cinema-theme', 'sunny-theme');
                
                // Add 3D theme effects
                if (themeName.includes('3d')) {
                    document.body.style.transform = 'perspective(1000px)';
                    document.body.style.transformStyle = 'preserve-3d';
                    
                    // Add 3D effects to elements
                    document.querySelectorAll('.product-card, .section-header, .nav-sidebar').forEach(el => {
                        el.style.transform = 'translateZ(20px)';
                        el.style.boxShadow = '0 20px 40px rgba(0,0,0,0.3)';
                        el.style.transition = 'transform 0.5s, box-shadow 0.5s';
                    });
                }
                
                // Apply theme-specific styles
                switch(themeName) {
                    case '3d-blue':
                        document.body.style.background = 'linear-gradient(135deg, #0f172a 0%, #1e3a8a 100%)';
                        break;
                    case '3d-green':
                        document.body.style.background = 'linear-gradient(135deg, #064e3b 0%, #065f46 100%)';
                        break;
                    case '3d-gold':
                        document.body.style.background = 'linear-gradient(135deg, #78350f 0%, #92400e 100%)';
                        break;
                }
                
                this.showNotification(`تم تطبيق الثيم ${themeName}`, 'success');
            },
            
            // بقية دوال الثيمات والقوالب...
            
            // قسم الموقع والمكان
            toggleLocationSection(show) {
                const locationSectionItem = document.getElementById('locationSectionItem');
                const locationSection = document.getElementById('location-section');
                
                if (locationSectionItem) {
                    locationSectionItem.style.display = show ? '' : 'none';
                }
                
                if (locationSection) {
                    locationSection.style.display = show ? '' : 'none';
                }
                
                // Save preference
                localStorage.setItem('show_location_section', show);
            },
            
            saveLocationData() {
                const address = document.getElementById('addressInput').value.trim();
                const gps = document.getElementById('gpsInput').value.trim();
                const phone = document.getElementById('phoneInput').value.trim();
                const whatsapp = document.getElementById('whatsappInput').value.trim();
                
                const locationData = {
                    address: address,
                    gps: gps,
                    phone: phone,
                    whatsapp: whatsapp,
                    timestamp: Date.now()
                };
                
                // Save to localStorage
                localStorage.setItem('site_location', JSON.stringify(locationData));
                
                // Save to Firebase
                if (firestore) {
                    firestore.collection('site_settings').doc('location').set(locationData);
                }
                
                // Update location section content
                this.updateLocationSection(locationData);
                
                this.showNotification('تم حفظ معلومات العنوان والموقع', 'success');
            },
            
            updateLocationSection(locationData) {
                const locationSection = document.getElementById('locationSectionContent');
                if (!locationSection) return;
                
                let content = '';
                
                if (locationData.address) {
                    content += `
                        <div style="margin-bottom: 30px;">
                            <h3 style="color: var(--primary); margin-bottom: 15px;">
                                <i class="fas fa-map-marker-alt"></i> العنوان
                            </h3>
                            <p style="font-size: 1.2rem; color: var(--dark);">${locationData.address}</p>
                        </div>
                    `;
                }
                
                if (locationData.gps) {
                    content += `
                        <div style="margin-bottom: 30px;">
                            <h3 style="color: var(--primary); margin-bottom: 15px;">
                                <i class="fas fa-location-arrow"></i> الموقع على الخريطة
                            </h3>
                            <a href="${locationData.gps}" target="_blank" style="color: var(--info); font-size: 1.1rem; text-decoration: none;">
                                <i class="fas fa-external-link-alt"></i> افتح في خرائط جوجل
                            </a>
                        </div>
                    `;
                }
                
                if (locationData.phone) {
                    content += `
                        <div style="margin-bottom: 30px;">
                            <h3 style="color: var(--primary); margin-bottom: 15px;">
                                <i class="fas fa-phone"></i> الهاتف
                            </h3>
                            <a href="tel:${locationData.phone}" style="color: var(--dark); font-size: 1.2rem; text-decoration: none;">
                                ${locationData.phone}
                            </a>
                        </div>
                    `;
                }
                
                if (locationData.whatsapp) {
                    content += `
                        <div style="margin-bottom: 30px;">
                            <h3 style="color: var(--primary); margin-bottom: 15px;">
                                <i class="fab fa-whatsapp"></i> واتساب
                            </h3>
                            <a href="https://wa.me/${locationData.whatsapp}" target="_blank" style="color: #25D366; font-size: 1.2rem; text-decoration: none;">
                                ${locationData.whatsapp}
                            </a>
                        </div>
                    `;
                }
                
                locationSection.innerHTML = content;
            },
            
            // Handle file upload
            handleFileUpload(files) {
                if (!files.length) return;
                
                const uploadPromises = [];
                
                for (let i = 0; i < files.length; i++) {
                    const file = files[i];
                    const uploadPromise = this.uploadFile(file);
                    uploadPromises.push(uploadPromise);
                }
                
                Promise.all(uploadPromises).then(results => {
                    const successfulUploads = results.filter(r => r.success).length;
                    
                    Swal.fire({
                        icon: 'success',
                        title: 'تم الرفع',
                        html: `تم رفع ${successfulUploads} من ${files.length} ملف بنجاح`,
                        timer: 2000
                    });
                }).catch(error => {
                    Swal.fire({
                        icon: 'error',
                        title: 'خطأ في الرفع',
                        text: error.message
                    });
                });
            },
            
            // Upload file to storage
            uploadFile(file) {
                return new Promise((resolve, reject) => {
                    // For local storage
                    if (STATE.activeStorage === 'local') {
                        const reader = new FileReader();
                        reader.onload = function(e) {
                            const fileData = {
                                name: file.name,
                                type: file.type,
                                size: file.size,
                                data: e.target.result,
                                timestamp: Date.now()
                            };
                            
                            const files = JSON.parse(localStorage.getItem('uploaded_files') || '[]');
                            files.push(fileData);
                            localStorage.setItem('uploaded_files', JSON.stringify(files));
                            
                            resolve({ success: true, file: fileData });
                        };
                        reader.onerror = reject;
                        reader.readAsDataURL(file);
                    }
                    // For Firebase storage
                    else if (STATE.activeStorage === 'firebase' && firebaseStorage) {
                        const storageRef = firebaseStorage.ref();
                        const fileRef = storageRef.child(`uploads/${Date.now()}_${file.name}`);
                        
                        fileRef.put(file).then(snapshot => {
                            snapshot.ref.getDownloadURL().then(downloadURL => {
                                resolve({ success: true, url: downloadURL });
                            });
                        }).catch(reject);
                    }
                    // For other storage (simulated)
                    else {
                        // Simulate upload delay
                        setTimeout(() => {
                            resolve({ success: true, simulated: true });
                        }, 500);
                    }
                });
            },
            
            // Change master codes
            changeMasterCodes() {
                const newMasterCode = document.getElementById('newCodeInput').value;
                const confirmMasterCode = document.getElementById('confirmCodeInput').value;
                const newEditCode = document.getElementById('newEditCodeInput').value;
                const confirmEditCode = document.getElementById('confirmEditCodeInput').value;
                
                // Validate master code
                if (newMasterCode && confirmMasterCode) {
                    if (newMasterCode !== confirmMasterCode) {
                        this.showNotification('كود التحكم غير متطابق', 'error');
                        return;
                    }
                    if (newMasterCode.length < 4) {
                        this.showNotification('كود التحكم يجب أن يكون 4 أحرف على الأقل', 'error');
                        return;
                    }
                    CONFIG.MASTER_CODE = newMasterCode;
                    document.getElementById('currentCodeInput').value = newMasterCode;
                }
                
                // Validate edit code
                if (newEditCode && confirmEditCode) {
                    if (newEditCode !== confirmEditCode) {
                        this.showNotification('كود التعديل غير متطابق', 'error');
                        return;
                    }
                    if (newEditCode.length < 4) {
                        this.showNotification('كود التعديل يجب أن يكون 4 أحرف على الأقل', 'error');
                        return;
                    }
                    CONFIG.EDIT_CODE = newEditCode;
                    document.getElementById('currentEditCodeInput').value = newEditCode;
                }
                
                // Clear inputs
                document.getElementById('newCodeInput').value = '';
                document.getElementById('confirmCodeInput').value = '';
                document.getElementById('newEditCodeInput').value = '';
                document.getElementById('confirmEditCodeInput').value = '';
                
                this.showNotification('تم تغيير الأكواد بنجاح', 'success');
            },
            
            // Connect to storage
            connectStorage(storageType) {
                STATE.activeStorage = storageType;
                localStorage.setItem('active_storage', storageType);
                
                this.showNotification(`تم الاتصال بنظام تخزين ${storageType}`, 'success');
            },
            
            // Sync all storage
            syncAllStorage() {
                this.showNotification('جارٍ مزامنة جميع أنظمة التخزين...', 'info');
                
                // Simulate sync process
                setTimeout(() => {
                    this.showNotification('تم مزامنة جميع أنظمة التخزين بنجاح', 'success');
                }, 1500);
            },
            
            // Disconnect all storage
            disconnectAllStorage() {
                STATE.activeStorage = 'local';
                localStorage.setItem('active_storage', 'local');
                
                this.showNotification('تم فصل جميع أنظمة التخزين', 'info');
            },
            
            // Submit comment
            submitComment() {
                const name = document.getElementById('commentName').value.trim();
                const text = document.getElementById('commentText').value.trim();
                
                if (!name || !text) {
                    this.showNotification('الرجاء إدخال الاسم والتعليق', 'error');
                    return;
                }
                
                const comment = {
                    id: `comment_${Date.now()}`,
                    name: name,
                    text: text,
                    date: new Date().toLocaleDateString('ar-SA'),
                    time: new Date().toLocaleTimeString('ar-SA'),
                    timestamp: Date.now()
                };
                
                // Add to UI
                this.addCommentToUI(comment);
                
                // Clear inputs
                document.getElementById('commentName').value = '';
                document.getElementById('commentText').value = '';
                
                // Save to STATE
                STATE.comments.push(comment);
                
                // Save to localStorage
                localStorage.setItem('site_comments', JSON.stringify(STATE.comments));
                
                // Save to Firebase
                if (firestore) {
                    firestore.collection('comments').doc(comment.id).set(comment);
                }
                
                this.showNotification('تم إضافة تعليقك بنجاح', 'success');
            },
            
            // Add comment to UI
            addCommentToUI(comment) {
                const container = document.getElementById('commentsContainer');
                const commentDiv = document.createElement('div');
                commentDiv.className = 'product-card';
                commentDiv.innerHTML = `
                    <div class="product-content">
                        <h3 class="product-title">${comment.name}</h3>
                        <p class="product-description">${comment.text}</p>
                        <div style="color: var(--gray); font-size: 0.9rem; margin-top: 15px;">
                            ${comment.date} - ${comment.time}
                        </div>
                    </div>
                `;
                container.appendChild(commentDiv);
            },
            
            // Apply custom colors
            applyCustomColors() {
                const primaryColor = document.getElementById('primaryColorPicker').value;
                const secondaryColor = document.getElementById('secondaryColorPicker').value;
                const accentColor = document.getElementById('accentColorPicker').value;
                
                const root = document.documentElement;
                root.style.setProperty('--primary', primaryColor);
                root.style.setProperty('--secondary', secondaryColor);
                root.style.setProperty('--accent', accentColor);
                
                // Save to localStorage
                localStorage.setItem('custom_primary', primaryColor);
                localStorage.setItem('custom_secondary', secondaryColor);
                localStorage.setItem('custom_accent', accentColor);
                
                this.showNotification('تم تطبيق الألوان الجديدة', 'success');
            },
            
            // Change header size
            changeHeaderSize(size) {
                const header = document.getElementById('mainHeader');
                
                // Remove all size classes
                header.classList.remove('header-small', 'header-medium', 'header-large', 'header-hidden');
                
                // Add selected size class
                if (size === 'hidden') {
                    header.classList.add('header-hidden');
                } else {
                    header.classList.add(`header-${size}`);
                }
                
                STATE.headerSize = size;
                
                // Update active button
                document.querySelectorAll('.header-size-btn').forEach(btn => {
                    btn.classList.remove('active');
                    if (btn.getAttribute('data-size') === size) {
                        btn.classList.add('active');
                    }
                });
            },
            
            // Change sidebar size
            changeSidebarSize(size) {
                const sidebar = document.getElementById('navSidebar');
                
                // Remove all size classes
                sidebar.classList.remove('nav-sidebar-small', 'nav-sidebar-medium', 'nav-sidebar-large');
                
                // Add selected size class
                sidebar.classList.add(`nav-sidebar-${size}`);
                STATE.sidebarSize = size;
                
                // Update active button
                document.querySelectorAll('.sidebar-size-btn').forEach(btn => {
                    btn.classList.remove('active');
                    if (btn.getAttribute('data-size') === size) {
                        btn.classList.add('active');
                    }
                });
            },
            
            // Toggle hidden scroll
            toggleHiddenScroll(enabled) {
                const sidebar = document.getElementById('navSidebar');
                STATE.hiddenScroll = enabled;
                
                if (enabled) {
                    sidebar.classList.add('nav-sidebar-scroll-hidden');
                } else {
                    sidebar.classList.remove('nav-sidebar-scroll-hidden');
                }
            },
            
            // Toggle smooth scroll
            toggleSmoothScroll(enabled) {
                STATE.smoothScroll = enabled;
                document.documentElement.style.scrollBehavior = enabled ? 'smooth' : 'auto';
            },
            
            // Apply UI settings
            applyUISettings() {
                localStorage.setItem('header_size', STATE.headerSize);
                localStorage.setItem('sidebar_size', STATE.sidebarSize);
                localStorage.setItem('hidden_scroll', STATE.hiddenScroll);
                localStorage.setItem('smooth_scroll', STATE.smoothScroll);
                
                this.showNotification('تم تطبيق إعدادات الواجهة', 'success');
            },
            
            // بقية الدوال...
            
            // Show notification
            showNotification(message, type = 'info') {
                // Create notification element
                const notification = document.createElement('div');
                notification.className = `notification notification-${type}`;
                notification.innerHTML = `
                    <div style="display: flex; align-items: center; gap: 15px;">
                        <i class="fas fa-${type === 'success' ? 'check-circle' : type === 'error' ? 'exclamation-circle' : 'info-circle'}"></i>
                        <span>${message}</span>
                    </div>
                `;
                
                // Style the notification
                notification.style.cssText = `
                    position: fixed;
                    top: 100px;
                    right: 30px;
                    background: ${type === 'success' ? '#10b981' : type === 'error' ? '#ef4444' : '#3b82f6'};
                    color: white;
                    padding: 15px 20px;
                    border-radius: var(--radius);
                    box-shadow: var(--shadow);
                    z-index: 100000;
                    animation: slideIn 0.3s ease;
                    max-width: 400px;
                `;
                
                // Add to document
                document.body.appendChild(notification);
                
                // Remove after 3 seconds
                setTimeout(() => {
                    notification.style.animation = 'slideOut 0.3s ease';
                    setTimeout(() => {
                        if (notification.parentNode) {
                            document.body.removeChild(notification);
                        }
                    }, 300);
                }, 3000);
                
                // Add CSS for animations
                if (!document.querySelector('#notification-styles')) {
                    const style = document.createElement('style');
                    style.id = 'notification-styles';
                    style.textContent = `
                        @keyframes slideIn {
                            from { transform: translateX(100%); opacity: 0; }
                            to { transform: translateX(0); opacity: 1; }
                        }
                        @keyframes slideOut {
                            from { transform: translateX(0); opacity: 1; }
                            to { transform: translateX(100%); opacity: 0; }
                        }
                    `;
                    document.head.appendChild(style);
                }
            },
            
            // Load initial data
            loadInitialData() {
                // Load saved edits
                this.loadSavedEdits();
                
                // Load saved location
                this.loadSavedLocation();
                
                // Load saved storage preference
                this.loadSavedStorage();
                
                // Load comments
                this.loadComments();
                
                // Load uploaded media
                this.loadUploadedMedia();
                
                // Load branding
                this.loadBranding();
                
                // Load store products
                this.loadStoreProducts();
                
                // Load location section preference
                this.loadLocationSectionPreference();
                
                // Load storage connections
                this.loadStorageConnections();
                
                // Generate products
                this.generateProducts();
                
                // Check URL hash for section
                this.checkUrlHash();
            },
            
            // Load location section preference
            loadLocationSectionPreference() {
                const showLocation = localStorage.getItem('show_location_section') === 'true';
                const checkbox = document.getElementById('showLocationSectionCheckbox');
                
                if (checkbox) {
                    checkbox.checked = showLocation;
                    this.toggleLocationSection(showLocation);
                }
            },
            
            // Load UI settings
            loadUIsettings() {
                const headerSize = localStorage.getItem('header_size') || 'medium';
                const sidebarSize = localStorage.getItem('sidebar_size') || 'medium';
                const hiddenScroll = localStorage.getItem('hidden_scroll') === 'true';
                const smoothScroll = localStorage.getItem('smooth_scroll') !== 'false';
                
                this.changeHeaderSize(headerSize);
                this.changeSidebarSize(sidebarSize);
                this.toggleHiddenScroll(hiddenScroll);
                this.toggleSmoothScroll(smoothScroll);
                
                // Update checkboxes
                document.getElementById('hiddenScrollCheckbox').checked = hiddenScroll;
                document.getElementById('smoothScrollCheckbox').checked = smoothScroll;
            },
            
            // Load saved edits
            loadSavedEdits() {
                Object.keys(localStorage).forEach(key => {
                    if (key.startsWith('edit_')) {
                        try {
                            const editData = JSON.parse(localStorage.getItem(key));
                            STATE.edits[editData.id] = editData;
                            
                            // Apply edit if element exists
                            const element = document.getElementById(editData.id);
                            if (element && editData.html) {
                                element.outerHTML = editData.html;
                            }
                        } catch (e) {
                            console.error('Error loading edit:', e);
                        }
                    }
                });
            },
            
            // بقية دوال تحميل البيانات...
            
            // بقية دوال التطبيق كما هي...
            
            // Initialize scroll reveal
            initScrollReveal() {
                const cards = document.querySelectorAll('.product-card:not(.revealed)');
                cards.forEach((card, index) => {
                    setTimeout(() => {
                        card.classList.add('revealed');
                    }, index * 100);
                });
            },
            
            // Setup Firebase listeners
            setupFirebaseListeners() {
                if (!firestore) return;
                
                // Listen for new orders
                firestore.collection('orders').onSnapshot(snapshot => {
                    snapshot.docChanges().forEach(change => {
                        if (change.type === 'added') {
                            const order = change.doc.data();
                            this.showNotification(`طلب جديد: ${order.productName}`, 'info');
                        }
                    });
                });
            },
            
            // Setup auto-save
            setupAutoSave() {
                // Auto-save edits every 30 seconds
                setInterval(() => {
                    if ((STATE.isOdoMode || STATE.editModeActive) && Object.keys(STATE.edits).length > 0) {
                        this.saveAllEditsToFirebase();
                    }
                }, 30000);
            },
            
            // دالة مساعدة للأيقونات
            getIconColor(type) {
                const colors = {
                    whatsapp: '#25D366',
                    phone: '#3b82f6',
                    instagram: '#E1306C',
                    tiktok: '#000000',
                    snapchat: '#FFFC00',
                    twitter: '#1DA1F2',
                    facebook: '#1877F2',
                    youtube: '#FF0000',
                    telegram: '#0088cc'
                };
                return colors[type] || '#64748b';
            },
            
            getIconName(type) {
                const names = {
                    whatsapp: 'واتساب',
                    phone: 'هاتف',
                    instagram: 'انستجرام',
                    tiktok: 'تيك توك',
                    snapchat: 'سناب شات',
                    twitter: 'تويتر',
                    facebook: 'فيسبوك',
                    youtube: 'يوتيوب',
                    telegram: 'تليجرام'
                };
                return names[type] || type;
            },
            
            // بقية الدوال المساعدة...
        };
        
        // Global functions for HTML onclick handlers
        function openControlPanel() {
            App.promptForCode(CONFIG.MASTER_CODE, App.openControlPanel.bind(App), "لوحة التحكم");
        }
        
        function activateEditMode() {
            App.promptForCode(CONFIG.EDIT_CODE, App.activateOdoMode.bind(App), "وضع التعديل");
        }
        
        // Initialize the application when DOM is loaded
        document.addEventListener('DOMContentLoaded', function() {
            App.init();
        });
    </script>
</body>
</html>